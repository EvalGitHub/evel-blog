<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>react使用优化实践 | 个人主页</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="学习总结">
    
    <link rel="preload" href="/assets/css/0.styles.d61d7785.css" as="style"><link rel="preload" href="/assets/js/app.a6319c82.js" as="script"><link rel="preload" href="/assets/js/2.32b4f8de.js" as="script"><link rel="preload" href="/assets/js/25.a6da7d87.js" as="script"><link rel="prefetch" href="/assets/js/10.e6cdc680.js"><link rel="prefetch" href="/assets/js/100.7cb870ce.js"><link rel="prefetch" href="/assets/js/101.dae61836.js"><link rel="prefetch" href="/assets/js/102.78465489.js"><link rel="prefetch" href="/assets/js/103.73b19d4b.js"><link rel="prefetch" href="/assets/js/104.3352cbff.js"><link rel="prefetch" href="/assets/js/105.376896af.js"><link rel="prefetch" href="/assets/js/106.04efd29c.js"><link rel="prefetch" href="/assets/js/107.01965d57.js"><link rel="prefetch" href="/assets/js/108.0b5ff5fd.js"><link rel="prefetch" href="/assets/js/109.69bd41aa.js"><link rel="prefetch" href="/assets/js/11.2c64db76.js"><link rel="prefetch" href="/assets/js/110.9d3426d1.js"><link rel="prefetch" href="/assets/js/111.7132a3b3.js"><link rel="prefetch" href="/assets/js/112.b5c69b85.js"><link rel="prefetch" href="/assets/js/113.1e51efc4.js"><link rel="prefetch" href="/assets/js/114.c393573b.js"><link rel="prefetch" href="/assets/js/115.6d892a14.js"><link rel="prefetch" href="/assets/js/116.388b6291.js"><link rel="prefetch" href="/assets/js/117.2572614d.js"><link rel="prefetch" href="/assets/js/118.bfa97115.js"><link rel="prefetch" href="/assets/js/119.6f3553d9.js"><link rel="prefetch" href="/assets/js/12.94a0c864.js"><link rel="prefetch" href="/assets/js/120.5833ff13.js"><link rel="prefetch" href="/assets/js/121.9afc513f.js"><link rel="prefetch" href="/assets/js/122.b1798e35.js"><link rel="prefetch" href="/assets/js/123.1388f4ed.js"><link rel="prefetch" href="/assets/js/124.5faa12b2.js"><link rel="prefetch" href="/assets/js/125.dda029c6.js"><link rel="prefetch" href="/assets/js/126.01846dd8.js"><link rel="prefetch" href="/assets/js/127.4452f08b.js"><link rel="prefetch" href="/assets/js/128.fc9974c4.js"><link rel="prefetch" href="/assets/js/129.879851df.js"><link rel="prefetch" href="/assets/js/13.c15f7eee.js"><link rel="prefetch" href="/assets/js/130.b18bae91.js"><link rel="prefetch" href="/assets/js/131.6bf951f3.js"><link rel="prefetch" href="/assets/js/132.ba1447bf.js"><link rel="prefetch" href="/assets/js/133.f3cf482f.js"><link rel="prefetch" href="/assets/js/134.a7f9d276.js"><link rel="prefetch" href="/assets/js/135.c5711373.js"><link rel="prefetch" href="/assets/js/136.17877c2e.js"><link rel="prefetch" href="/assets/js/137.c500801a.js"><link rel="prefetch" href="/assets/js/138.94e0eb60.js"><link rel="prefetch" href="/assets/js/139.848ea0dd.js"><link rel="prefetch" href="/assets/js/14.e95e7183.js"><link rel="prefetch" href="/assets/js/140.a23e12c0.js"><link rel="prefetch" href="/assets/js/141.11b60c34.js"><link rel="prefetch" href="/assets/js/142.50938741.js"><link rel="prefetch" href="/assets/js/143.26dfcd9e.js"><link rel="prefetch" href="/assets/js/144.e7f47e00.js"><link rel="prefetch" href="/assets/js/145.e94f18d8.js"><link rel="prefetch" href="/assets/js/146.fa956501.js"><link rel="prefetch" href="/assets/js/147.20ef4693.js"><link rel="prefetch" href="/assets/js/148.47047248.js"><link rel="prefetch" href="/assets/js/149.273a6d22.js"><link rel="prefetch" href="/assets/js/15.6a8d2980.js"><link rel="prefetch" href="/assets/js/150.78b24e2a.js"><link rel="prefetch" href="/assets/js/16.a73347db.js"><link rel="prefetch" href="/assets/js/17.1fed3083.js"><link rel="prefetch" href="/assets/js/18.89432a01.js"><link rel="prefetch" href="/assets/js/19.ab4be550.js"><link rel="prefetch" href="/assets/js/20.a3ffc242.js"><link rel="prefetch" href="/assets/js/21.c9e2b772.js"><link rel="prefetch" href="/assets/js/22.24933ab9.js"><link rel="prefetch" href="/assets/js/23.e12a523b.js"><link rel="prefetch" href="/assets/js/24.20ddc420.js"><link rel="prefetch" href="/assets/js/26.a9d704d0.js"><link rel="prefetch" href="/assets/js/27.bcc8207e.js"><link rel="prefetch" href="/assets/js/28.d34b0b94.js"><link rel="prefetch" href="/assets/js/29.f64a3b0d.js"><link rel="prefetch" href="/assets/js/3.2ead2ac8.js"><link rel="prefetch" href="/assets/js/30.c58fb139.js"><link rel="prefetch" href="/assets/js/31.5176cbd6.js"><link rel="prefetch" href="/assets/js/32.6f984b20.js"><link rel="prefetch" href="/assets/js/33.c52cc243.js"><link rel="prefetch" href="/assets/js/34.2301950a.js"><link rel="prefetch" href="/assets/js/35.59aff13a.js"><link rel="prefetch" href="/assets/js/36.be44a88b.js"><link rel="prefetch" href="/assets/js/37.51541bfb.js"><link rel="prefetch" href="/assets/js/38.34322281.js"><link rel="prefetch" href="/assets/js/39.778a9ac9.js"><link rel="prefetch" href="/assets/js/4.3fad1089.js"><link rel="prefetch" href="/assets/js/40.065f1d7f.js"><link rel="prefetch" href="/assets/js/41.c1df89aa.js"><link rel="prefetch" href="/assets/js/42.e28f3958.js"><link rel="prefetch" href="/assets/js/43.d1a4e2f5.js"><link rel="prefetch" href="/assets/js/44.07946160.js"><link rel="prefetch" href="/assets/js/45.261db7c1.js"><link rel="prefetch" href="/assets/js/46.68dd7ebc.js"><link rel="prefetch" href="/assets/js/47.6ddba031.js"><link rel="prefetch" href="/assets/js/48.a44dd332.js"><link rel="prefetch" href="/assets/js/49.150ce179.js"><link rel="prefetch" href="/assets/js/5.ef50e827.js"><link rel="prefetch" href="/assets/js/50.9093ca4f.js"><link rel="prefetch" href="/assets/js/51.615783a4.js"><link rel="prefetch" href="/assets/js/52.d8b9be33.js"><link rel="prefetch" href="/assets/js/53.1ff35abe.js"><link rel="prefetch" href="/assets/js/54.e94bfbfd.js"><link rel="prefetch" href="/assets/js/55.83bc9e19.js"><link rel="prefetch" href="/assets/js/56.4101382f.js"><link rel="prefetch" href="/assets/js/57.bf454b42.js"><link rel="prefetch" href="/assets/js/58.2636e755.js"><link rel="prefetch" href="/assets/js/59.2484001e.js"><link rel="prefetch" href="/assets/js/6.f2ff6c63.js"><link rel="prefetch" href="/assets/js/60.4d7205f6.js"><link rel="prefetch" href="/assets/js/61.b848f071.js"><link rel="prefetch" href="/assets/js/62.00f5fced.js"><link rel="prefetch" href="/assets/js/63.4035cbde.js"><link rel="prefetch" href="/assets/js/64.4acbf790.js"><link rel="prefetch" href="/assets/js/65.65f64452.js"><link rel="prefetch" href="/assets/js/66.9606b3e3.js"><link rel="prefetch" href="/assets/js/67.3a317ae6.js"><link rel="prefetch" href="/assets/js/68.2374ba12.js"><link rel="prefetch" href="/assets/js/69.085e0cc7.js"><link rel="prefetch" href="/assets/js/7.8b9b7a91.js"><link rel="prefetch" href="/assets/js/70.a65f45fa.js"><link rel="prefetch" href="/assets/js/71.59fba7c8.js"><link rel="prefetch" href="/assets/js/72.c2925a6a.js"><link rel="prefetch" href="/assets/js/73.b340a03e.js"><link rel="prefetch" href="/assets/js/74.c4c3f65c.js"><link rel="prefetch" href="/assets/js/75.3ab8205c.js"><link rel="prefetch" href="/assets/js/76.878e916a.js"><link rel="prefetch" href="/assets/js/77.4327b629.js"><link rel="prefetch" href="/assets/js/78.ea674f9e.js"><link rel="prefetch" href="/assets/js/79.1d9f4ab3.js"><link rel="prefetch" href="/assets/js/8.a70b9b8f.js"><link rel="prefetch" href="/assets/js/80.3936f401.js"><link rel="prefetch" href="/assets/js/81.45fd6a95.js"><link rel="prefetch" href="/assets/js/82.ce48eb4d.js"><link rel="prefetch" href="/assets/js/83.15f2e7cb.js"><link rel="prefetch" href="/assets/js/84.fbb6f3b6.js"><link rel="prefetch" href="/assets/js/85.230d4496.js"><link rel="prefetch" href="/assets/js/86.632513d4.js"><link rel="prefetch" href="/assets/js/87.5c1d4ec8.js"><link rel="prefetch" href="/assets/js/88.96beca6c.js"><link rel="prefetch" href="/assets/js/89.c9f1ec20.js"><link rel="prefetch" href="/assets/js/9.5fe5c710.js"><link rel="prefetch" href="/assets/js/90.a8dc4c84.js"><link rel="prefetch" href="/assets/js/91.9f5451d4.js"><link rel="prefetch" href="/assets/js/92.4257589f.js"><link rel="prefetch" href="/assets/js/93.25c57580.js"><link rel="prefetch" href="/assets/js/94.8d85d934.js"><link rel="prefetch" href="/assets/js/95.abe2f5b4.js"><link rel="prefetch" href="/assets/js/96.fef0c8f2.js"><link rel="prefetch" href="/assets/js/97.d192dbc6.js"><link rel="prefetch" href="/assets/js/98.a7f643e6.js"><link rel="prefetch" href="/assets/js/99.69afcc55.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d61d7785.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="../assets/logo.png" alt="个人主页" class="logo"> <span class="site-name can-hide">个人主页</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/react/" class="nav-link router-link-active">
  react
</a></div><div class="nav-item"><a href="/vue/" class="nav-link">
  vue
</a></div><div class="nav-item"><a href="/error.html" class="nav-link">
  附录：错误码
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/react/" class="nav-link router-link-active">
  react
</a></div><div class="nav-item"><a href="/vue/" class="nav-link">
  vue
</a></div><div class="nav-item"><a href="/error.html" class="nav-link">
  附录：错误码
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>文档介绍</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>react</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/react/" aria-current="page" class="sidebar-link">REACT 篇</a></li><li><a href="/react/mobx-react的使用.html" class="sidebar-link">mob-react的使用</a></li><li><a href="/react/mobx的学习与使用.html" class="sidebar-link">mobx的学习与使用</a></li><li><a href="/react/react-redux的学习与使用.html" class="sidebar-link">react-redux的学习与使用</a></li><li><a href="/react/react中关于state的不常用技巧.html" class="sidebar-link">react中关于state的不常用技巧</a></li><li><a href="/react/react中抽离公共逻辑复用的方式.html" class="sidebar-link">react中优雅抽离公共逻辑的方式</a></li><li><a href="/react/react中组件之间的相互通信.html" class="sidebar-link">react中组件相互通信的方式</a></li><li><a href="/react/react使用优化实践.html" class="active sidebar-link">react使用优化实践</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react使用优化实践.html#this的绑定问题" class="sidebar-link">this的绑定问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/react/react使用优化实践.html#_1-渲染时的绑定" class="sidebar-link">1）渲染时的绑定</a></li><li class="sidebar-sub-header"><a href="/react/react使用优化实践.html#_2-渲染时使用箭头函数" class="sidebar-link">2）渲染时使用箭头函数</a></li><li class="sidebar-sub-header"><a href="/react/react使用优化实践.html#_3-在constructor中绑定" class="sidebar-link">3）在constructor中绑定</a></li><li class="sidebar-sub-header"><a href="/react/react使用优化实践.html#_4-函数申明式" class="sidebar-link">4）函数申明式</a></li></ul></li><li class="sidebar-sub-header"><a href="/react/react使用优化实践.html#jsx中的判断" class="sidebar-link">jsx中的判断</a></li><li class="sidebar-sub-header"><a href="/react/react使用优化实践.html#在react中-组件的state-props改变都会导致整个组件的的重新渲染" class="sidebar-link">在react中，组件的state，props改变都会导致整个组件的的重新渲染</a></li><li class="sidebar-sub-header"><a href="/react/react使用优化实践.html#保持稳定的dom结构" class="sidebar-link">保持稳定的Dom结构</a></li><li class="sidebar-sub-header"><a href="/react/react使用优化实践.html#循环列表不要轻易使用数组的index-作为key值" class="sidebar-link">循环列表不要轻易使用数组的index,作为key值</a></li></ul></li><li><a href="/react/react全局方法使用.html" class="sidebar-link">react全局方法的使用</a></li><li><a href="/react/react函数编程hook基本用法.html" class="sidebar-link">react函数编程hook</a></li><li><a href="/react/react合成事件与原生事件.html" class="sidebar-link">react合成事件与原生事件</a></li><li><a href="/react/react生命周期.html" class="sidebar-link">react生命周期</a></li><li><a href="/react/react的diff过程.html" class="sidebar-link">react的diff过程</a></li><li><a href="/react/redux-saga的学习与使用.html" class="sidebar-link">react-saga的使用实践</a></li><li><a href="/react/redux与react-redux的使用实践.html" class="sidebar-link">redux与react-redux的使用实践</a></li><li><a href="/react/setState的实现原理.html" class="sidebar-link">setState的异步分析及实现原理</a></li><li><a href="/react/使用errorboundary优化错误处理.html" class="sidebar-link">关于errorboundary的使用</a></li><li><a href="/react/创建一个全局toast.html" class="sidebar-link">创建一个全局toast</a></li><li><a href="/react/对setState的理解.html" class="sidebar-link">对setState的理解</a></li><li><a href="/react/浅析react_fiber.html" class="sidebar-link">浅谈react-fiber</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>vue</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端杂记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>js</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>构建工具篇-webpack等</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>flutter</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5开发汇总</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>web 安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>http 协议</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>node相关</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>pwa</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>浏览器原理&amp;性能优化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端工程化</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>babel</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>3D探索</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react使用优化实践"><a href="#react使用优化实践" class="header-anchor">#</a> react使用优化实践</h1> <h3 id="setstate-只管理渲染相关的数据"><a href="#setstate-只管理渲染相关的数据" class="header-anchor">#</a> setState 只管理渲染相关的数据</h3> <p>临时变量，数据，以及其他只是用来做标记或者与后端交互这些值不应该用setState</p> <h2 id="this的绑定问题"><a href="#this的绑定问题" class="header-anchor">#</a> this的绑定问题</h2> <h3 id="_1-渲染时的绑定"><a href="#_1-渲染时的绑定" class="header-anchor">#</a> 1）渲染时的绑定</h3> <div class="language- extra-class"><pre class="language-text"><code>render() {
    return (
        &lt;User onClick = {this.getUsername.bind(this)}&gt;&lt;/User&gt;
    )
}
</code></pre></div><p><strong>劣势</strong>：每次重新渲染组件时都会创建一个新的函数。虽然听起来好像很严重，但实际上对性能的损耗并不明显。</p> <h3 id="_2-渲染时使用箭头函数"><a href="#_2-渲染时使用箭头函数" class="header-anchor">#</a> 2）渲染时使用箭头函数</h3> <div class="language- extra-class"><pre class="language-text"><code>render () {
    return (
    	&lt;div onClick={e =&gt; this.getUsername(e)}&gt;&lt;/div&gt;
    )
}
</code></pre></div><p><strong>劣势</strong>：该方式和上一种本质是相同的，都会有潜在的性能问题。</p> <h3 id="_3-在constructor中绑定"><a href="#_3-在constructor中绑定" class="header-anchor">#</a> 3）在constructor中绑定</h3> <div class="language- extra-class"><pre class="language-text"><code>class User extends React.component &lt;initProps, initState&gt; {
    constructor （props） {
        super(props)
        this.getUsername = this.getUsername.bind(this)
    }
    
}
</code></pre></div><p><strong>优点：</strong> 构造函数只会在组件第一次挂载时执行，所以整个生命周期中只会执行一次。在构造函数中对方法进行this绑定，就不会像前面的方法那样重复创建新函数而造成性能问题</p> <p>**劣势：**如果方法很多的时候，这个构造函数的可读性就很差了。</p> <h3 id="_4-函数申明式"><a href="#_4-函数申明式" class="header-anchor">#</a> 4）函数申明式</h3> <div class="language- extra-class"><pre class="language-text"><code>class User extends Component {
    selectUser = (e) =&gt; {
        ...
    }
    render () {
        return (
        	&lt;div onClick={this.selectUser}/&gt;
        )
    }
}
</code></pre></div><p>**优点：**使用下面的方法完美解决上面的所有问题。既不会造成性能问题，也不会导致代码冗长难于阅读。</p> <h2 id="jsx中的判断"><a href="#jsx中的判断" class="header-anchor">#</a> jsx中的判断</h2> <p>&amp;&amp;运算会比三目运算性能更好，同时更建议使用css样式进行隐藏，渲染。</p> <div class="language- extra-class"><pre class="language-text"><code>return (
    { title &amp;&amp;
      &lt;div className=&quot;tui-dialog__hd&quot;&gt;
        &lt;strong className=&quot;weui-dialog__title&quot;&gt;{title}&lt;/strong&gt;
      &lt;/div&gt;
    }
)
</code></pre></div><h2 id="在react中-组件的state-props改变都会导致整个组件的的重新渲染"><a href="#在react中-组件的state-props改变都会导致整个组件的的重新渲染" class="header-anchor">#</a> 在react中，组件的state，props改变都会导致整个组件的的重新渲染</h2> <p>为了避免不必要的re-render和diff, 可以在shouldComponentUpdate其中进行判断</p> <blockquote><p>接收两个参数，分别为待更新的属性及状态值</p></blockquote> <div class="language- extra-class"><pre class="language-text"><code>shouldComponentUpdate(nextProps, nextState) {
 // 如果当前的value值与待更新不相等，才执行更新
 return this.props.value !== nextProps.value || this.state.user !== nextState.user;
}
</code></pre></div><p>React v15.3开始提供了一个叫做 PureComponent 的组件来替代 Component 来封装 shouldComponentUpdate 以达到上述目的。</p> <p>但是这样实际上有一个问题，它们进行的都是浅比较，也就是说如果对比的值是一个对象或者数组是不是深层次的遍历比较的，出于性能考虑。</p> <p>解决这个问题：</p> <ol><li>Immutable.js 用来替代浅拷贝和深拷贝的方式，用来创建不可变的数据。</li></ol> <blockquote><p>Immutable 实现的原理是 Persistent Data Structure（持久化数据结构），也就是使用旧数据创建新数据时，要保证旧数据同时可用且不变。同时为了避免 deepCopy 把所有节点都复制一遍带来的性能损耗，Immutable 使用了 Structural Sharing（结构共享），即如果对象树中一个节点发生变化，只修改这个节点和受它影响的父节点，其它节点则进行共享。</p></blockquote> <blockquote><p><code>Immutable.is</code> 比较的是两个对象的 <code>hashCode</code> 或 <code>valueOf</code>（对于 JavaScript 对象）。由于 immutable 内部使用了 Trie 数据结构来存储，只要两个对象的 <code>hashCode</code> 相等，值就是一样的。这样的算法避免了深度遍历比较，性能非常好。</p></blockquote> <p>[Immutable 详解及 React 中实践
]&lt;(https://zhuanlan.zhihu.com/p/20295971?columnSlug=purerender)&gt;
<strong>父组件的re-render都会导致子组件的re-render而引发的重新计算问题</strong></p> <p>如果父组件的state发生了变化，会导致父组件重新渲染的同时也会导致子组件的重新渲染，这就会存在一个性能问题，如果子组件依赖的props没有什么变化并且存在很大批量的复杂运算，这种无意义的重复计算就会很没必要，有如下的解决方案：</p> <ol start="2"><li>使用PureComponent + 将计算逻辑放在render函数中</li></ol> <p>使用PureComponent可以避免子组件的重新render，计算逻辑放在render中就可以避免没必要的重新计算了。</p> <ol start="3"><li>使用<a href="https://www.npmjs.com/package/memoize-one" target="_blank" rel="noopener noreferrer">mermoization<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>帮助函数进行缓存</li></ol> <p>只是进行浅比较（a === b），如果需要对数组或者对象进行处理需要自定义比较函数</p> <blockquote><p>memoize-one simply remembers the last arguments, and if the function is next called with the same arguments then it returns the previous result.</p></blockquote> <p>参考：<a href="https://zh-hans.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html#what-about-memoization" target="_blank" rel="noopener noreferrer">你可能不需要使用派生 state<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="保持稳定的dom结构"><a href="#保持稳定的dom结构" class="header-anchor">#</a> 保持稳定的Dom结构</h2> <p>通过css影藏或者显示节点而不是真正的移除或者添加DOM节点。</p> <blockquote><p>React只会简单地考虑同层级节点的位置变换，而对于不同层级的节点，只有创建和删除操作。</p></blockquote> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhQAAAE1CAMAAACIvInZAAAATlBMVEX/////HBzIyconJyefoaT69va0trj/BASJi5AHBwfb3N3r7Oz/MjL/S0v/5eVFRUX/0dH/YWFhYWH/dXX/u7t5eXn/lZX/qKj/hobUvr6iCl5aAAAdY0lEQVR42uxdD3/iKBBV/oVAFEVT+/0/6TEkuhUSQ9vgpTCze+v+rt7VwsvMm2HmsduhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaGhoaFlNs61xlVAe+CBCMbcb8mEIArXAw0Q4X55TLgX9xeBHqNySAjpYDDAQYHDkJIRgrCo2ZSDg4MEURwAAv8o5SKIQnpRsZtwgYMQvdM8CCgKQVErJsBL6B2f+IpCvlmnaUaY4HNf1JrjEtWHCSnkC3fAdxhBKqSYUi6ECEVwmSrjE1K+3nMXPQiioioTDhOvSQN3FJQh3awreLAEzkAkEouqHMWyE+DE5ay4VvU4iqTddqCQGEBqyUbhhCOFjYq096EVYETKNA9AmERXUVH0SKpXQuIqcL3qiB4i3GplwfoQKhA/JC5YFaCQUeFKtBLMtCQGBWaldUSPiD6Kdni1JmYfWNaswYRkkk+D4v76BT8IimpAEaYZd1DQABQMk9JqQTF6CEX7mH4gKKoFhXFGWznBSTH9qMCg+BCDwjf3GxrmpAiKeonmyCl4G8QKjZyiEmNx8eGedRjkFJXaxNHHo05ho5SUYUpag0HxQUyDorcRfhR2dVfBNOOYcK9TMBrSD4mt/nWYjOIH18+v/+DDqsEE14oQomr1jCKVPqpqitwKWg8JTFjDiBSp8BAQSEXS4aeoo0ihCQzdwxClNy/IQGpzGDzRVagqWmxGNQb3h9LOCPFyDPVN08I5V0JgcO/iFayFAD0GxyX+/axcEaGqdBWLAaQKRkEkkQqUF54x4GFRm6sAf7mQWKgaiplCzCJfVxdAIHC+3nMIMaWTcA6pxvwPqWtDheea7PUjpIrHhJxX6BijSFXMwh+gs7mBUsVYFZhYzK4qq2X5/hkyedylfXApXfeKk0Va5VagMrqph0INC8t3ClI0Wb4KgVqu4bssVVcmx6C9XOJQqtG+cONydeW8BAiaEF64kg1PI00uT6us5k0GTHgYeBMEclU5FHm17AsOqM5RiuUfT7v1qG1w0rEHou4lf3m3MUsjxJhiUaFZWvsQdCRVV9vUxBf+v9gjc9e2b02pvjN18l7XOWOtFfmHilGReUSMMa0tNAlhqW3qoNxSZ4sFV4oQQUJJbk17Wqav4MkiPYrh5GSwIqanRTpPEkvL9i0YtQrjxxIqqGlLXBIR67ZY69spbKsiUOA8VPBIUVsiKuDUYxeCYngNZ19Qo2MCFc6n2uKC6sRp4B0U4eyLkCj8FT9ULW0pKQ4Ucs5TUBYnr8g0I6LeUtqW1W8DswsxKDjnjlNQjaBIKGQ4Xl4YKviUp2iH9EPvYlBg+hEvoYHVKomCazlHNJUxCIq0NaSAir6s8DFDNFUbthJg+JgrV5TlK6bEWEZQ8EA2Ml2fuDoTHhXl8AoRH37es4+wLINS1C9RYU0xDRYi3uq5lJRJhrWruWVsTWuik4E/Gw9j9niPJ72M6Afu/pxJKiFjK4OI69QZa6/bgps/7ysM1CtMGUyTpSaarCKJjp8spACyaUURawQ5RUrzjMYiRQoqyshMU10FwyPSxefL5SCmjNOxYeApgZBi4WrRm/a2pX0xrmLJC0DPN276MiqIKaSIpfyMNV/ABKYeSU8YlLyLoBWea76iFVpg8Eh2FpCDFJCCDHo+s76CE2zZ/c4j5lDx3PmvFcwUMSH+lPrLkIHMTBADnUBMfGMxobTZP1ChvOLgKEIp/pIKpRrkGCbEbDTMAEnCsW6VbOZLvVt5JMj7BLv0GqV/wV8IwhQ020ghgrFSrr0ag3ToRlCkuwpzb/F2TlaMYgYgMKe1cv6C6D8gACMsc86OO88GXVgeywSm5NyHF2IYswbNEoGw+AYqqOV6R2A5BeH6q5/ljl9s3lUIY30RjoP+MsD6nxzD4PCU/xHKlmNYGxUwSOXoO5F6QuafK7JxGWNCzaPa4tyDeh68f9Q6uWSOUiMsUo0xLsh8/4natK9QtP9aa9EPXe777L1+uMS+iPT7beUK5yZe+AO9YVrhMEGfwoLm6iHYLp5yDk4NNVjBSsXE8oj+VnNTDRsdeTJHjGDCOAKQKVi6ZW1SkSDbwLeJCkUtZelEQTlKikWsJEzAscCiCKXaYkLHv3t2Q9oiB+8zsPeEi6Tc1zd4VSG0hNjvpypYr0hI81Makhx729zJs6Ytpd/9UKR1/xGyzaU4uxg8xhjDNtZ6oUxLv+sohsH7FlGxlI3G87mTW7C1JhUYiv2JtBvvy5NjyMAo0jZ7Y1elA5+g7U+eeG2Lk2PIwCjS1mdbrkKbnw/EDnIMPe797OLGIpT+iDEuS0AfpNgOJugvBhQ0LU2kY22aGYHChVxnrZkQodyKz+V+V38+4KbasgbvM0SPIPcYArUKBaO02I7eufWtQb/4MILC1AuiYo4+Rpnmnb0Z+0NKmt1k7xyZ+dVn8eqReGj6bVCQlodOZRtd8qCkYH97sCXd/4Tioen02syDYhckfGojKmLwkK9QlGQGepbxJGTaU4g5UAQ6MFsBxUpKbnyQeZIYQaKVmbjnduOg8BqZdI2tZIAKi2wzAgV7FT5ERDT/f1Bos149krXl6Pms7CnkLNHUkaf433mZli7xWO0qSZilpRR7sSJPMQsKazaYkorWJaPr7aIipcgxrErl450eQMH74AaVtL6L/JkHtWt+Cg4Ha0grglWO+zNb21tr4p6D/18diJP1c8hy5BjWjNFR/BjHJSbe+cYn6niM/10PxHB9VgMHIVPeh1fLNbhMZQpvEqHkt8vhcOi6Zn84f5y+Zp59rkMsEaJC+6l7OAAURNVYxxAy0QO8RTLq49w5TJzP3b7r3MvlcH7gwuePNsc39Sfpj4EiJUCNgXlYgEoHE/XhQiW6CpW/SME/9ofLYb/vDpfzx+XQ7Zumu32eT3eKOXGryzrfF85cx/O1hxrDqNIBafjfkGNY3VUs13ohd838wFw75x/23eUGdAK+F7/ezpfb9XS9P825jq8GOQY+tBy536NWC3wG0PUhSteGCp0kTZpfhPLSHQ6Xy3XHT0/79Xm4ASikNbTPtjUOFYZwrhiEDhctgqrd31J6WsVYgjRp9uDBz92hue6m5GZuHzfYJpWV0kClDmSQyORH2Lwcw/r7Afo1r0sQKneN4nj47A7HuS9eT8fdLnOCKDTIv80+G1pVlqB6rvnqdpTsjdzH/WH/+QK2zyEll8N8Oe1UXdViQIV65UmyEorroWkur99yOmdmVmJxopZXdi+EL1aw6cFbLxeUNaTy8xIm3He/fWYNoWqxWuN4TUWTyUopn4E46h3tvVfIy13K/HSYOL7eEBc+Dre8vnLpdjENEzG1oEJb4jZdSFCghCDCv0LCC82xvIIlp6bZL3MGft1fs6blJOVtlTTkaNP7+QflNUiFr94MpohPSxjJLEv60TTLToDfDl2X7XOk3RnkvGYdt8hoasYDBQ2qyx4FctChHLTEmM68DqemOyQkF5/nrvnIxSgYS2nmAlCIOvwEfUzEaBCpDTQos9/jyV3msU9wAfyS9r6fGEm8rlDJGi6c4g4TT81tQnwVoWQivxjptdkvpaPjG7t9JlfBUw+KeRUXRBgTTdXw4WYH9i4F/2PTJdBMMJe4dnk+Qzxk/cKlFJ6AKAOHTBPKy28UvOfQOjGx+vHhF790TXPMEz1YsNWkB4u9Ain+zillN3Ar0HG/byaKlWaixfqzSUlTfmCxxoJonUvobSSzpmXh8UOZdgPys0cXE+LooVtBJ9hHk8Y+vg+KsCOVDd+d22ASTbOyb0vXZhPCTx+TlStpd/Hg1nXfNIc8RYoQFHdIciojULyv8/vtQvl6I7NRN5d8xETBsd8+asc8OU6xfw8o2N1PyeeBKH9/3dsWjVGpxBtn8gZtuQ1wpssUKOBBVW24+Nx5iibHAxmPQz6Cl2iDL7wTFMJIY8zbSMxvtOXeAAoLLtpEfhpAwfOAQs14CjIBirc9SoLCTJZ7etl7MEG3og53dqA4RTRTfd2Y3KCYmJwUmwCFb2D3j+8bBHf0L7Xl1rRPl5KGp5/S6/NFw2AZw8cspwiR+W5QwE55ZWGb+bvq3s85bKMyB54iLD5QpsBsUKo4ZiKaE2IsD09hbQyKty2cals/FTdY1r4vLntDzVYuyHEpaXiicRdgC4XYoKSRo04xUZG6OwgSeKv3Hn4o0/o7B0ZU5FSZBxX7zWBid4yLD4+nMyBYVwefLE8Lix7/wVNoGUprcYeJhUZOvtNKBTfj8vEE2k8jyr63UC/trXvpffeKcKknXCOuhttU3V8F/I3Rlg0RZPgjHwtcSVtuNetc/HhewcfT2T/Tns+muWU5+4iJwrgXkfqqfgEKcMD3h7oVQnP/SzG33/TxBSstHahjS9vQjBc6tsb27k0OMy7MEztgYnxzJsI5SEZtSI8BJkafenL5Y3+CrvoupWvvp+nH8/Zz4DQTbQPiBc1UwnO1yOjT7tPpd4zugP7H3tVwOarC0FJFrQUEQeD//9KX0HbbCn7MzmqZN3LeOW9mdzqrEpObkHtTdDcN7MfP9uOf32Tnmu14un+bfqxsnhEbnXzcGQ6rHsk8874sRhZw3+j7H4caclcMfRf9yKW4M5qvJZ7OlkhfbM7Dpajef7TfpJ2hBTjbdzkd9Ml65eEnRA+50TWUKw8/Zwm1bTiC73vsUekgBNzGrsO33aUDAPFwCh2EBQwNsMLeV+fr6yBx+BKbGcIfVBC/3mxiG3EunIpzyYzTwte5CrFZi82tTWKNq1jBvH8fFR92+drCtmNf/Fdf8+pS9C8RZyvBtgZ/dWZdhhJRxXJg0Ns5ihsHrvyeo9gq1D/XJuUriv9Klx/3TUH8WOR0QJTZkDgY2pUX5/WWzb4PD7frgT+6/jt+QhirOWdcW/Oev137IS+I+We/OVukA8ntWrlvgWGFHMPu6oDV8Agd3Xf034TlnCvtOSPMK/jy+QLehulk2WDoOPiKWaYPtlJsyRq8iczO7vl1/2lZbfE4Eev//l+WioAlEMIYwZevJuAu9KOG3GU8IEmjUcxYhdX1ZkSgl7S0nCG5fGKCWhPqFx1mon/tJThhgOSZdhLbsYUwYCDKGBMc87CZttw/yUDQhKciiERJNL31JdxYUO0kEt0bUNz2rPveUZgD78C5F0LQV4ChuMHvWyyQDNlSFsKpuOepnRcOc1YrN7+GMPioqlIqq+gmmmp3ONYHo/jGkYSvNXGCxttuLD7Q8tz3ZcaMN4lHIEwRPdp8oSAYgr3sYM6h/7I5N2N9RHoOOqsf0Kbov1mwUp6QKSQWFKPg3k45Lwh+qobwBzjICCOkkFJQ5wAdQejYwU+EJ9QgcMAic0uvt3Vq2+omovgBiF5+6wRMMMVmZD/gCW+uI/b9ZYNPQP3lGv+ra4VE87rmXu51Ce1Ne7ksH5z78qHG8JGsre2b77xlNVmo7Bh3yn4Jzz1yOwipCVpDWITLHf02bWH/X+UYmlk1sJyXgrdq4cnR/V63b2yJsEpxUr8sxs2+13DFdpd3MYbyJ46p9OBi57ccEhLBRfY3cm3Pwvk/TqIm2qag8+Ze+/wix7AT9/5fL/C4ZMkNgEEonj2HvmxCz7Iwzjrlb/WVdviE775eW9Tk/rnqy3ZNtU9ITXTud9J1FxphraI/HevL8AyyuBWRQTNeZx5Azl0XG0DXF9UxTvYvMo81zSdG1XXmrmLoiri+VnXFMfbty4gCcvpVWrQ+Se/OCWYWRYq0lg9F5ecsl+BiJpdUde1zvpMmfYjb5NkEknX00CxVt2rj1FqobUh3/85RXJKeAjlS3bHRX1myZimokOjUoVgVElk7imRnamgOOsaRfw1SpCSj2kusA4PipLXJ9066qb3HTpDi2OkvLICPid7Fpm+jjD8QLPIFFefJZsEKSTSHq/jC0hA+YqMozqeIBnmyG+mI/aPo0V+6CeiABMvL+djr1QvlHRLv1ulURk8Y+d0s1/ugHez8xEHxucu5k/CnGAU+3Wvki9Eosk0/ApycqFLRHuJHf5Q1Vz9LnlD8uQZduYg8IuqMjSKQ4adaStoiC3XHH+QpYkzRXJC92hUJoJmvUQxgE5PO4Aq+4jCK1YsnCppFHzoBxohd5gw06Xw74jkDFfGf5Cmi4sNDKmpcqkDmXa5HYm0zX6BCyHFkpWuXI1Hx4QEmxpK1dit1oH+wEGbOeYJhL4XR/8WCmED4CGY+3PAIuIFTMZkaRYtFyzmjuN6iCzVOa6W8k0csmVvY5voGKp5z4s/vDpdldvRBJbbdhe09F0uOoBpO0iumuNWccO451+bY/KmFih+rhBtETkVu4RRjynPGuOLKy+t1CTE4xjV8hnFkACA64lZ5cex/cvm1gtU+H0dhwBQ047dmfsIgICg7f22G1wpbzEJ7NxXOKEa4M+7wFmknTNbNyxHZ1Lgd7C3YAzgIZyQqrMCVWaNn8A6FuEHAsVDzYv3UaW4OV5FeltVr1KB0JufmAmIAIcy7QI4Pm0yF9ffv0x8Bx8JEwgCM9YerSD+yRRmYu6PIonBliGbamGieIWQVZuIeJFeTZCfp5GEBSbCAilELWBOZ/jlkcY4TMsFwlNbRdLTRzMylMIcFJCMDrxf4QNifmQHDmHrINdz0/kqR+EPINszCbz1MILHlIUeb2XSj8+B8+JqTWWgoIrNAFvqSL7CHs0h53lvmPv1+AtanOdhETRbSBTNKTVEVb4ETCR/gB7BIxd1A2lcyjdOwvJVB7mYWJVThIu1bLBB+ueIm0J0cVpFOOFOKUSdqOOP4YD/vKHDY08LeUXGizL4XYdiyOQvH2XEWkoqrNWcE8hD2mqMJCckc6ouZLK6w1ssbLO0rhPCzUOmZ0vCtVTZ/LNrEUxDGIfcE58BgWRfSEkgBs3iNWIqgEt0FCl+9REW2xiiQ0UIOV5HGk0QFKwDjCGdGLEjCsEyOmVH6bg0Y5c+JlNiAumqzEWgfrmLqNVPasvptkUzSNUPWZcVUPc9oKNj2OuV+v06O4Vf6itPVKvaiI0aUzOXEyK8lx7unq5Dg9CJHgVKnUTOnJ1kzIj+5ymq4UoBqSnFOmA56eOc8mtggtpF1Lz0mKfefhJuImgLKS9EXkTKxY5nLLHxudY+ufvrHP5yrPFobDeHj6FGFsXrduK//RTGBxUc6TWjfvQ4jppOpc2ZEfnKdu5jKf81EB8bFJxhl0bbtuRwTSMOhbwg02AEygo/XR0t3N0QfIocFJNbQJWYA9EMWc2ktGMU4ENzcGh1Th81j+CAaxSgmDA+CU9VEMac+ktJ4gVNI8GXORZHDYFoeU14f48TH8c0+FBNkfMo3OUdL1RuOnfvBa0IyqsvCKtSkp2jHRGjzILKZ2CgmAZKqj/Qjhe+L9Mjj5lJkwK3ikF1GRlGdq6qJTFY+QKOLh9hOGgWvs2gYydBRJB9Zi1NzPx5uWVxdKi8dzvqNNGrQKNjdKMZAc0rBIhjF4SmiNSkX1m02Dnn9AiDIpsLH2FW8GsW4R6R/0GPPw4Epllc1ycYcigVK3l5Ak46v+G4co5xUvmCKcZW7etxi/06eDqckR7t/Ih+dUJvE+NF9msePKaNIZx/VJU5Jgy1QFlNV7urt1SiPxb6Lw1FE+WjXX7oJFDb0gDU/HEASco0Poxi6KCW99wqxWPizLbqyPQ/jPEvm0VuWm1FcpmUFcQ7up4vdJma8lsUZVjWMi1cAD+7HeD6h8XhtOvB7Yzkvl70Y/ScWcvknM8/m80LGAseC0RGmCGcf0XBe9qc2iRqP65pn+NFkkzIKCBGTk7opoNAPGwW2RqwrJIjnPDRRr2yeESuJ978vfMyccdDm4+JAvF5JcLYvuWXoJlzhAvRRpPiLXW8/Ph4Bc4o1O4d5xBM/slXK0eI4N0+topiXNB8+L4Sv1rkK+xZlNFlTlNJH4SqxUOx8FjT8mY9MpTSfUUMzfM1b/+YosJCFAFUs2tHRtfvqOOljz+ePQmnXUypRTUgrThhXyu79boVxI0ttxFSNpmk6vthTZVYIMfwSEGEV54wg0Ucb0VZlM/9caKsZ1xwWzhEnXHm+pCj0r1egL5JZW6QREZoq/JCevjnq2PJU1l/hH7TCN16DVXD4Ar60gi58olaaEDAGa6XzCvsgvdX7BhLsrp19qakn0d8H8fHpcqVU7Mg8cIMVAaMghKF82K2jX1s/W9BzhKNFOPNUFJIWPiT2fcV0kD0T064kpawSGPU6PfGcOsQcB6CgFnaX1FyHUjA+QuE810Y6Oh2oGecOg8X7fhjt3b7B+MZfM1OhI00sNIHAwiLuNHKf4EkQ8esBhYD95cjoeOcCSnAaU89GcB46qRN/L92+uCJMHFE8FQyQJFxzkbocSEF4rVXNXi9WUBPeDuZ+/UGYRBRBU/sL/kJOOGXNpoGalHJfmwZ3wHXN311UoBWD+zNTZk0gsCCtniGSAojtpdcBoTj6623CcD2NxKVJ7a8Afz0vh7XrY6WaQNbJECJ755213kvhNTKimTSTtmtRmBcBCRpHQCbhf3pfk85yuVrNZV8i4XzNCnkgtWtQdsHrI34gd75rUN4l1sxehuXe8tsH7jxZSKyPFopwkrzwZoxFzMXi1HtKAZDsbNvcm/v+PinyftEyITkhr3R6b46SVUBp8zZBx1ZBPdjEwqODX6n29RWUSs7fFBOIXpMGgfli+Q0L39weTiI8EqzSzD86yEjkm0vFYSDLUVcYsjdjWwij+D18MP0VhW0hKD0dLuJZ+VnThshftRHtqsYWx/h/7Z3ddqsgEIWLhmoiGAhUef8nPQxRkwAmrHUuWlz7u229CcMwzM/mN/T9uaLqnMUK/weiSCfOyae7hu2EKEgBWy3Q4Vjl4eE6UbJw2sdu2zel8/lT98feDAJFqLJHPUKvktu+YWUeQMm/+wwheBMq+AUu2sw03r31vYrc1FRGQFFDcrDKMLNUJ46yVUtwKUUyv/l1ueaGQIxAQ1t9WCHjZPU3PV3dn+J2XKXXdvcxIzh4Ov9cvpq+vaVBBXTEamNKBQf7NjxongzQbdEl77r47jEs/32JunhHhn7oGpMULF60ZQTzFI2akzjpPfqY05bITTIqkgmioT6Ik1aYpBB5o/iKRzG3UV6bepe9EeSgSIdfuT6jiD1Ff11OgmEnPiBBusgodmc/BDIV9cH2jo/mGsWMQSkqJB1S4WMea469GAWuHwcwinPgyjNGoZc4JO5zPjfwFIdh7FKj6K/DMFyaWxsrDq5GMfkr6Z643NCkRoHs1XECzVhv9On4SJIPt3W2MJaMEgg0q4N3qTbpahT9NTUKt7qMqKJxWc6PJjpHFHVF42euzlMk7n01hp8o0vQOYpmeoEGZJBAh9e7vWNjd249DSFEbUyooe/cU/Du+ZsotZJSZd1dO7blNax/UjIOQojZmlhS3+3Pb5opbbBOU1Cyn+jM0Q8YRMVxIqyMMVL7u5eFCJAusHoZA0UXRRROSUZUmKlhhHdM9slBBfKykeQZKMHUSZBpK7iniqbLlynJSHNWwSs+PMkkwchSPvotRFFU/4ShqpWzXR5JRQZ30kylZqNXWyshK1OUiQclRfn4cRaE/s2JXIbuPlwQXHzGfdaYs5IGqjjXpAHk7Qe5Y8ugF5brFfsjA6XF0JLgrPkAEVUD2rYIWOG3pp1yo/4rvuAkmoEFZ9w3kLuew89eZyaxMJZ06RufEpNREE9wWN4+qoRSlNDK3iqMjLZjc+DbplforCBOv0/vchxukCzMhyKw92CQZFyNkXL2aNS3w3jDxxDSpxwghnZ3VbOfZ8mki9Sk2WRRH6/cVTIpOewMw8ziq0aP4OJOKoncGu4VOkk8jqQ+2SsFIHURD5Iyj4xjRJq2sCLpAVNrwm91RCrzTb+NFKw2Njr0oCjEJkzgKVuo5SNcS6/p25oPEKCdloBfJKGlgEwdyFtZo8ywZRartBWUvZR9fyQkqYofzFvPTrhemuGuKYhA1WYXo8qD+wi+uM8YgzQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD4Lf4BwBdBbcnH1kgAAAAASUVORK5CYII=" alt="avatar"></p> <p>形如上面的例子如果在进行diff更新的操作是：create A -&gt; create B -&gt; create C -&gt; delete A
因此在实际开发中进行dom的删除增加操作相比样式的隐藏来说效率更低。</p> <p>常见dom增减操作：</p> <div class="language- extra-class"><pre class="language-text"><code>render () {
  return (
    &lt;&gt;
      {
        this.state.isShow ? &lt;p&gt;i am here&lt;/p&gt; : &lt;p&gt;i am there&lt;/p&gt;
      }
    &lt;/&gt;
  )
}
</code></pre></div><p>样式隐藏：</p> <div class="language- extra-class"><pre class="language-text"><code>render() {
  return () {
    &lt;&gt;
      &lt;p className={['item', this.state.isShow ? 'show ' : ''].join(' ')}&gt;i am here&lt;/p&gt; 
    &lt;/&gt;
  }
}
</code></pre></div><h2 id="循环列表不要轻易使用数组的index-作为key值"><a href="#循环列表不要轻易使用数组的index-作为key值" class="header-anchor">#</a> 循环列表不要轻易使用数组的index,作为key值</h2> <p>react使用的是虚拟DOM,diff算法去优化前端性能，其中在diff算法中判断两个节点是否相同的时候会使用到元素的key值(如果有的话，没回key的话就会进行遍历查找对应的旧接点)；所以如果提供了key值，如果key值在新旧对比中是相同的则会复用，然后如果你使用的是index作为key值的话，就可能会出现一些界面显示与实际值不一致的问题。</p> <p><strong>关于不使用index作为key的讲解：</strong></p> <ul><li><a href="https://medium.com/@robinpokorny/index-as-a-key-is-an-anti-pattern-e0349aece318" target="_blank" rel="noopener noreferrer">Index as a key is an anti-pattern<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://muyiy.cn/question/frame/1.html" target="_blank" rel="noopener noreferrer">关于使用key的价值讨论<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>参考：</p> <p><a href="https://www.jianshu.com/p/c46e5866eaec" target="_blank" rel="noopener noreferrer">react组件化原理及优化实践<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://mp.weixin.qq.com/s/JYglFA5sTnUikimfyLRbCQ" target="_blank" rel="noopener noreferrer">送给react开发者的八条优化建议<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><a href="https://zhuanlan.zhihu.com/p/78516581" target="_blank" rel="noopener noreferrer">深入 react 细节之 - batchUpdate<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">1/23/2021, 6:40:39 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/react/react中组件之间的相互通信.html" class="prev">
        react中组件相互通信的方式
      </a></span> <span class="next"><a href="/react/react全局方法使用.html">
        react全局方法的使用
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.a6319c82.js" defer></script><script src="/assets/js/2.32b4f8de.js" defer></script><script src="/assets/js/25.a6da7d87.js" defer></script>
  </body>
</html>
