(window.webpackJsonp=window.webpackJsonp||[]).push([[120],{582:function(e,t,r){"use strict";r.r(t);var s=r(28),a=Object(s.a)({},(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"在线文件预览"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#在线文件预览"}},[e._v("#")]),e._v(" 在线文件预览")]),e._v(" "),r("p",[r("strong",[e._v("背景")]),e._v("：项目开发中，经常会遇到文件在线预览的需求，例如，pdf、word、excel等等")]),e._v(" "),r("h2",{attrs:{id:"使用ifram-embed展示pdf"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#使用ifram-embed展示pdf"}},[e._v("#")]),e._v(" 使用ifram|embed展示pdf")]),e._v(" "),r("ul",[r("li",[e._v("iframe")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('<iframe src="http://****.pdf">\n  this browser dose not support PDFS, Please download this file by click <a href="http://****.pdf"></a>\n</iframe>\n')])])]),r("p",[e._v("优点：这是最常见｜简单的的一个展现方式\n缺点：各种浏览器展示形式可能有所不同，特别是在h5手机场景下, 有些不能全部加载pdf文件，有的干脆直接没展示，有的展示下载文件")]),e._v(" "),r("ul",[r("li",[e._v("embed")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('<embed src="https://****.pdf" type="application/pdf" />\n')])])]),r("p",[e._v("这个标签是自闭合标签，所以不能像iframe那样给出不支持的提示。")]),e._v(" "),r("h2",{attrs:{id:"使用pdfobject库"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#使用pdfobject库"}},[e._v("#")]),e._v(" 使用"),r("a",{attrs:{href:"https://pdfobject.com/#the-why",target:"_blank",rel:"noopener noreferrer"}},[e._v("PDFObject"),r("OutboundLink")],1),e._v("库")]),e._v(" "),r("p",[r("strong",[e._v("使用方式：")])]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('export default function(props) {\n  function loadPdfObjectJs(src) {\n    return new Promise((resolve, reject) => {\n      function importScript(src) {\n        if (!src) return;\n        let script = document.createElement(\'script\');\n        script.src = src;\n        document.body.appendChild(script);\n        script.onload = function () {\n          resolve(true);\n        };\n      }\n      importScript(src);\n    });\n  }\n\n  async function createPdf() {\n    await loadPdfObjectJs(\'https://cdn.bootcdn.net/ajax/libs/pdfobject/2.2.6/pdfobject.min.js\');\n    if(PDFObject.supportsPDFs){\n      console.log("Yay, this browser supports inline PDFs.");\n    } else {\n      console.log("Boo, inline PDFs are not supported by this browser");\n      return;\n    }\n    PDFObject.embed("https://gw.alipayobjects.com/os/bmw-prod/4fad10ee-da9f-45ad-87c6-f4204e12125d.pdf", "#example1");\n  }\n\n  React.useEffect(() => {\n    createPdf();\n  }, [])\n\n  return <div>\n    <h3>PDFObject文件展示方式</h3>\n    <div id="example1"></div>\n  </div>\n}\n')])])]),r("p",[r("strong",[e._v("note：PDFObject使用的是 PDFObject原理是创建一个embed标签，所以在使用的时候需要检测下，你的浏览器是不是支持embed标签")])]),e._v(" "),r("h2",{attrs:{id:"使用pdf-js"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#使用pdf-js"}},[e._v("#")]),e._v(" 使用"),r("a",{attrs:{href:"https://mozilla.github.io/pdf.js/getting_started/",target:"_blank",rel:"noopener noreferrer"}},[e._v("PDF.js"),r("OutboundLink")],1)]),e._v(" "),r("ul",[r("li",[r("p",[e._v("使用方式："),r("a",{attrs:{href:"https://mozilla.github.io/pdf.js/examples/",target:"_blank",rel:"noopener noreferrer"}},[e._v("example"),r("OutboundLink")],1)])]),e._v(" "),r("li",[r("p",[e._v("原理：pdf生成多张canvas, 然后进行绘制。")])])]),e._v(" "),r("h2",{attrs:{id:"使用第三方服务-【微软-百度】服务"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#使用第三方服务-【微软-百度】服务"}},[e._v("#")]),e._v(" 使用第三方服务 【微软｜百度】服务")]),e._v(" "),r("p",[e._v("微软提供了免费的在线渲染接口，使用前提是文件必须是公共网络可以访问到，不能设置读取控制权限")]),e._v(" "),r("ul",[r("li",[r("a",{attrs:{href:"https://www.microsoft.com/en-us/microsoft-365/blog/2013/04/10/office-web-viewer-view-office-documents-in-a-browser/?eu=truehttp://view.xdocin.com/index.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("微软"),r("OutboundLink")],1),e._v("方式")])]),e._v(" "),r("p",[e._v('使用 "http://view.officeapps.live.com/op/view.aspx?src=" + "你的文档链接"')]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('let url = "https://view.officeapps.live.com/op/view.aspx?src=http://video.ch9.ms/build/2011/slides/TOOL-532T_Sutter.pptx";\n\n<iframe src="url">\n  this browser dose not support PDFS, Please download this file by click <a href="http://****.pdf"></a>\n</iframe>\n')])])]),r("ul",[r("li",[r("a",{attrs:{href:"https://view.xdocin.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("百度"),r("OutboundLink")],1)])]),e._v(" "),r("p",[e._v("使用 https://view.xdocin.com/view?src=你的文档地址")]),e._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('let url = "https://view.xdocin.com/view?src=https%3A%2F%2Fview.xdocin.com%2Fdoc%2Fpreview.docx";\n\n<iframe src="url">\n  this browser dose not support PDFS, Please download this file by click <a href="http://****.pdf"></a>\n</iframe>\n')])])]),r("h2",{attrs:{id:"sheet-js"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#sheet-js"}},[e._v("#")]),e._v(" "),r("a",{attrs:{href:"https://sheetjs.com/",target:"_blank",rel:"noopener noreferrer"}},[e._v("sheet.js"),r("OutboundLink")],1)]),e._v(" "),r("p",[e._v("支持解析excel")]),e._v(" "),r("h2",{attrs:{id:"spread-js"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#spread-js"}},[e._v("#")]),e._v(" "),r("a",{attrs:{href:"https://www.grapecity.com/spreadjs/demos/quickstart",target:"_blank",rel:"noopener noreferrer"}},[e._v("spread.js"),r("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=a.exports}}]);