(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{535:function(e,t,n){"use strict";n.r(t);var a=n(28),s=Object(a.a)({},(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[n("h1",{attrs:{id:"reactå‡½æ•°ç¼–ç¨‹hook"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#reactå‡½æ•°ç¼–ç¨‹hook"}},[e._v("#")]),e._v(" reactå‡½æ•°ç¼–ç¨‹hook")]),e._v(" "),n("p",[n("strong",[e._v("å®šä¹‰")])]),e._v(" "),n("blockquote",[n("p",[e._v("Hook æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§")])]),e._v(" "),n("p",[n("strong",[e._v("è§£å†³é—®é¢˜ï¼š")])]),e._v(" "),n("ul",[n("li",[e._v("classç»„ä»¶é€»è¾‘éš¾å¤ç”¨ï¼ˆé«˜é˜¶ç»„ä»¶ï¼Œrender propsï¼‰ ---\x3e è‡ªå®šä¹‰hookå®ç°é€»è¾‘çš„å¤ç”¨ï¼Œå› ä¸ºç»„ä»¶å’Œ Hook éƒ½æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥æ“ä½œèµ·æ¥å¾ˆæ–¹ä¾¿ã€‚")]),e._v(" "),n("li",[e._v("classç»„ä»¶ä»£ç è¶‹äºå¤æ‚ä¸æ˜“è¢«ç†è§£ ---\x3e ä½¿ç”¨function")]),e._v(" "),n("li",[e._v("classç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸä¸­å¾€å¾€ä¼šæ³¨å…¥è®¸å¤šé€»è¾‘ä»£ç ,ç”šè‡³æ˜¯æ»¥ç”¨ ---\x3e å»æ‰æ„é€ å‡½æ•°ã€ç”Ÿå‘½å‘¨æœŸæå‡æ€§èƒ½ï¼ŒuseEffectä¸­å¯ä»¥è¿”å›å›è°ƒå‡½æ•°æ¸…é™¤å‰¯ä½œç”¨ï¼Œè€Œä¸éœ€è¦åœ¨å¤šä¸ªç”Ÿå‘½å‘¨æœŸä¸­å†™å…¥å¤„ç†ä»£ç ")]),e._v(" "),n("li",[e._v("classç»„ä»¶thisçš„å¿…é¡»é‚¦å®šï¼Œ hookä¸­ä¸éœ€è¦ç»‘å®šthis")])]),e._v(" "),n("p",[e._v("è‡³äºæ€§èƒ½æ–¹é¢çš„æå‡è¿˜æœ‰å¸¦å•†æ¦·ã€‚")]),e._v(" "),n("p",[n("strong",[e._v("å¥½å¤„")])]),e._v(" "),n("blockquote",[n("p",[e._v("ä»æ­¤å¯ä»¥å¾ˆæµç•…çš„ç¼–å†™æ— çŠ¶æ€ç»„ä»¶ï¼Œå‡å°‘ä»£ç é‡")])]),e._v(" "),n("p",[n("strong",[e._v("æ³¨æ„")])]),e._v(" "),n("ul",[n("li",[n("p",[e._v("Hookä¸èƒ½åœ¨classç»„ä»¶ä¸­ä½¿ç”¨")])]),e._v(" "),n("li",[n("p",[e._v("ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–è€…åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨hookï¼Œç¡®ä¿æ€»æ˜¯åœ¨Reactæœ€é¡¶å±‚è°ƒç”¨")]),e._v(" "),n("p",[e._v("åˆ—ä¸¾ä¸€ç§ç»å¸¸çš„é”™è¯¯ï¼š")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("  // ğŸ”´ åœ¨æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨ Hook è¿åç¬¬ä¸€æ¡è§„åˆ™\n  if (name !== '') {\n    useEffect(function persistForm() {\n      localStorage.setItem('formData', name);\n    });\n  }\n")])])]),n("blockquote",[n("p",[e._v("ç¡®ä¿ Hook åœ¨æ¯ä¸€æ¬¡æ¸²æŸ“ä¸­éƒ½æŒ‰ç…§åŒæ ·çš„é¡ºåºè¢«è°ƒç”¨ã€‚è¿™è®© React èƒ½å¤Ÿåœ¨å¤šæ¬¡çš„ useState å’Œ useEffect è°ƒç”¨ä¹‹é—´ä¿æŒ hook çŠ¶æ€çš„æ­£ç¡®ã€‚")])])])]),e._v(" "),n("p",[n("strong",[e._v("å› ä¸ºreact hookçš„å†…éƒ¨å®ç°æ˜¯æ–¹å¼æ˜¯ä½¿ç”¨é“¾è¡¨æ¥è®°å½•æ¯ä¸ªhookçš„æ‰§è¡Œé¡ºåºçš„ï¼›å¦‚æœåœ¨æ¡ä»¶è¯­å¥ç­‰éreactç»„ä»¶é¡¶å±‚å£°æ˜çš„hokä¼šå¯¼è‡´è®°å½•é¡ºåºå‡ºé”™ã€‚")])]),e._v(" "),n("p",[n("a",{attrs:{href:"https://www.jianshu.com/p/b9ac8fa849f1",target:"_blank",rel:"noopener noreferrer"}},[e._v("react hookåŸç†"),n("OutboundLink")],1)]),e._v(" "),n("h2",{attrs:{id:"usestate"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#usestate"}},[e._v("#")]),e._v(" useState")]),e._v(" "),n("blockquote",[n("p",[e._v("import React, { useState } from 'react';")])]),e._v(" "),n("ul",[n("li",[e._v("useStateä¼šè¿”å›ä¸€å¯¹å€¼ï¼šå½“å‰çŠ¶æ€ã€æ›´æ–°çŠ¶æ€çš„å‡½æ•°ï¼›ç±»ä¼¼ class ç»„ä»¶çš„ this.setStateï¼Œä½†æ˜¯å®ƒä¸ä¼šæŠŠæ–°çš„ state å’Œæ—§çš„ state è¿›è¡Œåˆå¹¶")]),e._v(" "),n("li",[e._v("useState å”¯ä¸€çš„å‚æ•°å°±æ˜¯åˆå§‹state")]),e._v(" "),n("li",[e._v("ä½¿ç”¨Object.isè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœä¼ å…¥çš„å€¼ç›¸ç­‰å°±ä¸ä¼šæ›´æ–°ï¼Œè¿™ç‚¹ç›¸å¯¹äºclassç»„ä»¶æ¥æ—¶æ˜¯åšäº†ä¼˜åŒ–å¤„ç†ï¼Œä¸éœ€è¦æ‰‹åŠ¨å»ä½¿ç”¨\nshouldComponentUpdateå»åˆ¤æ–­ã€‚")])]),e._v(" "),n("p",[e._v("å‡½æ•°ç»„ä»¶ï¼š")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import * as React from 'react';\nexport function Example () {\n  const [count, setCount] = React.useState(0);\n  const [obj, setObj] = React.useState({\n    name: 'æµ‹è¯•å¯¹è±¡',\n    age: 12\n  })\n  return (\n    <div>\n      <p>You clicked {count} times</p>\n      <p>You age {obj.age} </p>\n      <button onClick={() => setCount(count + 1)}>\n        Click me\n      </button>\n      <button onClick={() => setObj({...obj, age: obj.age+1})}>\n        Add you age\n      </button>\n    </div>\n  );\n}\n")])])]),n("blockquote",[n("p",[e._v("å¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨ state ä¸­å­˜å‚¨ä¸¤ä¸ªä¸åŒçš„å˜é‡ï¼Œåªéœ€è°ƒç”¨ useState() ä¸¤æ¬¡å³å¯ã€‚")])]),e._v(" "),n("p",[e._v("ä¼ å…¥å‡½æ•°")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("setState(prevState => { // å¯ä»¥æ‹¿åˆ°ä¸Šä¸€æ¬¡çš„ state å€¼\n  // ä¹Ÿå¯ä»¥ä½¿ç”¨ Object.assign\n  return {...prevState, ...updatedValues};\n});\n")])])]),n("p",[n("strong",[e._v("æƒ°æ€§çš„åˆå§‹åŒ–")])]),e._v(" "),n("blockquote",[n("p",[e._v("è¯¥initialStateå‚æ•°æ˜¯åœ¨åˆå§‹æ¸²æŸ“ä¸­ä½¿ç”¨çš„çŠ¶æ€ã€‚åœ¨åç»­æ¸²æŸ“ä¸­ï¼Œå°†å¿½ç•¥å®ƒã€‚å¦‚æœåˆå§‹çŠ¶æ€æ˜¯æ˜‚è´µçš„è®¡ç®—ç»“æœï¼Œåˆ™å¯ä»¥æä¾›ä¸€ä¸ªå‡½æ•°ï¼Œè¯¥å‡½æ•°ä»…åœ¨åˆå§‹æ¸²æŸ“å™¨ä¸Šæ‰§è¡Œï¼š")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const [state, setState] = useState(() => {\n  const initialState = someExpensiveComputation(props);\n  return initialState;\n});\n")])])]),n("p",[n("strong",[e._v("æºç åˆ†æ")])]),e._v(" "),n("p",[e._v("å¸¸è§„ç”¨æ³•ï¼šconst [count, setCount] = React.useState(0)\nè¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªstateå€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¿®æ”¹stateçš„å‡½æ•°")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("Object.assing(React,  {\n  useState(initVal:any) {\n   function setVal(val:any) {\n     initVal = val;\n   }\n   return [initVal, setVal] \n  }\n})\n")])])]),n("h2",{attrs:{id:"useeffect"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#useeffect"}},[e._v("#")]),e._v(" useEffect")]),e._v(" "),n("p",[n("strong",[e._v("å‰¯ä½œç”¨/ä½œç”¨çš„æ¦‚å¿µ")])]),e._v(" "),n("blockquote",[n("p",[e._v("æ•°æ®è·å–ã€è®¢é˜…æˆ–è€…æ‰‹åŠ¨ä¿®æ”¹è¿‡ DOMã€‚æˆ‘ä»¬ç»Ÿä¸€æŠŠè¿™äº›æ“ä½œç§°ä¸ºâ€œå‰¯ä½œç”¨â€ï¼Œæˆ–è€…ç®€ç§°ä¸ºâ€œä½œç”¨â€ï¼›å¯åˆ†ä¸ºéœ€è¦æ¸…é™¤çš„å‰¯ä½œç”¨ï¼Œå’Œä¸éœ€è¦æ¸…é™¤çš„å‰¯ä½œç”¨ã€‚")])]),e._v(" "),n("p",[n("strong",[e._v("useEffectçš„ä½œç”¨")])]),e._v(" "),n("blockquote",[n("p",[e._v("useEffect å°±æ˜¯ä¸€ä¸ª Effect Hookï¼Œç»™å‡½æ•°ç»„ä»¶å¢åŠ äº†æ“ä½œå‰¯ä½œç”¨çš„èƒ½åŠ›ã€‚å®ƒè·Ÿ class ç»„ä»¶ä¸­çš„ componentDidMountã€componentDidUpdate å’Œ componentWillUnmount å…·æœ‰ç›¸åŒçš„ç”¨é€”")])]),e._v(" "),n("p",[n("strong",[e._v("ä½¿ç”¨useEffectï¼šä¸éœ€è¦æ¸…é™¤çš„å‰¯ä½œç”¨")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import React, { useState, useEffect } from 'react';\nfunction Example() {\n  const [count, setCount] = useState(0);\n  useEffect(() => {\n    document.title = `You clicked ${count} times`;\n  });\n  return (\n    <div>\n      <p>You clicked {count} times</p>\n      <button onClick={() => setCount(count + 1)}>\n        Click me\n      </button>\n    </div>\n  );\n}\n")])])]),n("blockquote",[n("p",[e._v("é»˜è®¤åœ¨ç»„ä»¶æŒ‚è½½å®Œä¹‹åï¼Œå’Œç»„ä»¶æ›´æ–°ä¹‹åéƒ½ä¼šæ‰§è¡Œ")])]),e._v(" "),n("p",[n("strong",[e._v("ä½¿ç”¨useEffectï¼šéœ€è¦æ¸…é™¤çš„å‰¯ä½œç”¨")])]),e._v(" "),n("ul",[n("li",[e._v("åªéœ€è¦åœ¨useEffectä¸­è¿”å›ä¸€ä¸ªå‡½æ•°ï¼ŒReactå°†ä¼šåœ¨"),n("strong",[e._v("ç»„ä»¶å¸è½½æ—¶")]),e._v("æ‰§è¡Œæ¸…é™¤æ“ä½œ")]),e._v(" "),n("li",[e._v("æ¯ä¸ª effect éƒ½å¯ä»¥è¿”å›ä¸€ä¸ªæ¸…é™¤å‡½æ•°,å¯é€‰çš„æ¸…é™¤æœºåˆ¶")]),e._v(" "),n("li",[e._v("ä¼šåœ¨è°ƒç”¨ä¸€ä¸ªæ–°çš„effectä¹‹å‰å¯¹å‰ä¸€ä¸ªeffectè¿›è¡Œæ¸…ç†ï¼Œå¯¹äºéœ€è¦æ¸…ç†çš„å‰¯ä½œç”¨(å®šæ—¶å™¨ï¼Œç›‘å¬å™¨)æˆ‘ä»¬éœ€è¦å®šä¹‰è¿™ä¸ªå‡½æ•°ï¼Œ\nå¹¶ä¸”ä¸ºé˜²æ­¢å†…å­˜æ³„æ¼ï¼Œæ¸…é™¤å‡½æ•°ä¼šåœ¨ç»„ä»¶å¸è½½å‰æ‰§è¡Œã€‚")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import React, { useState, useEffect } from 'react';\nfunction FriendStatusWithCounter(props) {\n  const [count, setCount] = useState(0);\n  useEffect(() => {\n    document.title = `You clicked ${count} times`;\n  });\n\n  const [isOnline, setIsOnline] = useState(null);\n  useEffect(() => {\n    function handleStatusChange(status) {\n      setIsOnline(status.isOnline);\n    }\n    ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);\n    return () => {\n      ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);\n    };\n  });\n  // ...\n}\n")])])]),n("p",[e._v("å¯¹äºä¸Šé¢çš„ä¾‹å­æˆ‘ä¹ˆä¼šå‘ç°ï¼Œæ¯ä¸€æ¬¡çš„ç»„ä»¶æ›´æ–°éƒ½ä¼šæ‰§è¡Œ"),n("strong",[e._v("document.title = `You clicked ${count} times")]),e._v("ï¼Œé—®é¢˜æ˜¯æœ‰æ—¶å€™å³ä½¿æˆ‘ä»¬æ²¡æœ‰æ›´æ–°countä½†è¿˜æ˜¯ä¼šæ‰§è¡Œè¿™å¥è¯ï¼Œå°±æ˜¯æ²¡æœ‰å¿…è¦çš„æ€§èƒ½æµªè´¹ã€‚")]),e._v(" "),n("ul",[n("li",[e._v("classç»„ä»¶ä¸­å¯ä»¥åšå¦‚ä¸‹ä¼˜åŒ–")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("componentDidUpdate (preProps, preState) {\n  if(preState.count !== this.state.count) {\n    document.title = `You clicked ${count} times\n  }\n}\n\n")])])]),n("ul",[n("li",[e._v("åœ¨useEffectä¸­")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("useEffect(() => {\n  document.title = `You clicked ${count} times`;\n}, [count]); // ä»…åœ¨ count æ›´æ”¹æ—¶æ›´æ–°\n")])])]),n("blockquote",[n("p",[e._v("å¦‚æœæ•°ç»„ä¸­æœ‰å¤šä¸ªå…ƒç´ ï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªå…ƒç´ å‘ç”Ÿå˜åŒ–ï¼ŒReact ä¹Ÿä¼šæ‰§è¡Œ effectã€‚")])]),e._v(" "),n("h3",{attrs:{id:"å…³äºç¬¬äºŒä¸ªå‚æ•°"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#å…³äºç¬¬äºŒä¸ªå‚æ•°"}},[e._v("#")]),e._v(" å…³äºç¬¬äºŒä¸ªå‚æ•°")]),e._v(" "),n("p",[e._v("å¸¸è§çš„ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœç¬¬äºŒä¸ªå‚æ•°çœç•¥äº†åœ¨useEffectä¸­æ‰§è¡Œäº†ç›¸å…³çš„å¼‚æ­¥æ“ä½œå¹¶ä¸”ä¿®æ”¹äº†æŸä¸ªçŠ¶æ€ï¼Œä¼šå‘ç°ä¸€ç›´å¾ªç¯çš„æ‰§è¡Œä¸‹å»ï¼Œ\nè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ä¼ å…¥äº†ä¸€ä¸ªç©ºæ•°ç»„ï¼ˆ[]ï¼‰å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¼ å…¥ä¸€ä¸ªç©ºæ•°ç»„çš„ä½œç”¨å°±ç›¸å½“äºæ˜¯çŠ¶æ€ç»„ä»¶çš„componentDidMountedä¸­\næ‰§è¡Œä¸€æ ·ï¼Œåªä¼šåœ¨ç»„ä»¶mountä¹‹åï¼Œummountä¹‹å‰æ‰§è¡Œã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("å‡½æ•°ç»„ä»¶åˆå§‹åŒ–ï¼Œä»¥åŠçŠ¶æ€æ›´æ–°çš„æ—¶å€™(å¦‚æœæ²¡æœ‰æä¾›ç¬¬äºŒä¸ªå‚æ•°)ï¼Œéƒ½ä¼šæ‰§è¡ŒuseEffectã€‚")])]),e._v(" "),n("p",[n("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/65773322",target:"_blank",rel:"noopener noreferrer"}},[e._v("useEffectä½¿ç”¨æŒ‡å—"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("strong",[e._v("æºç åˆ†æ")])]),e._v(" "),n("p",[e._v("useEffectæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªæ•°ç»„")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("Object.assign(React, {\n  let _tmp = null;\n  useEffect(callback, depArr:any[]) {\n    if (!_tmp) {\n      _tmp = depArr.slice();\n    }\n    let _shouldUpdate = depArr.length === 0 ? true : depArr.every((item:any, index:number) => _tmp[index]) ? false : true;\n    if (_shouldUpdate) {\n      callback();\n      _tmp = depArr.slice();\n    }\n  }\n})\n")])])]),n("p",[n("strong",[e._v("è¿›ä¸€æ­¥æ‹“å±•")])]),e._v(" "),n("blockquote",[n("p",[e._v("åœ¨react hookçš„ä½¿ç”¨é™åˆ¶ä¸­æ˜ç¡®æŒ‡å‡ºï¼ŒreactHookå¿…é¡»åœ¨å‡½æ•°ç»„ä»¶çš„æœ€é¡¶å±‚å»ºç«‹ï¼Œä¸èƒ½åœ¨æ¡ä»¶è¯­å¥å¾ªç¯è¯­å¥ï¼Œä»¥åŠè‡ªå®šä¹‰çš„å‡½æ•°ä¸­å»ºç«‹çš„åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ")])]),e._v(" "),n("p",[e._v("é¦–å…ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨å®šä¹‰React.useStateã€React.useEffectçš„æ—¶å€™æˆ‘ä»¬å¯ä»¥å»ºç«‹å¤šä¸ªï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šå‡ºç°æ··æ·†ï¼ŒåŸå› å°±æ˜¯hookçš„æºç ä¸­ä½¿ç”¨æ•°ç»„æ¥å­˜å‚¨ç€ä»–ä»¬çš„å®šä¹‰é¡ºåºï¼ˆå¤šä»¥ç¦å¿Œåœ¨æ¡ä»¶è¯­å¥ä¸­å®šä¹‰ï¼‰ã€‚")]),e._v(" "),n("p",[e._v("è¿›ä¸€æ­¥ä¼˜åŒ–ä¸Šé¢çš„æºç ï¼š")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const React = (function(){\n  let hooks = [];\n  let currentIndex = 0;\n  return Object.design(React, {\n    useState(initStateVal) {\n      hooks[currentIndex] = initStateVal;\n      function setState(val) {\n        hooks[currentIndex] = val;\n      }\n      return [hooks[currentIndex++], setState]\n    },\n   \n    useEffect(callback, depArr) {\n      hooks[currntIndex] = depArr.slice();\n      let shouleUpdate = depArr.length === 0? hooks[currntIndex].every((item:any, index:number) => hooks[currntIndex][index] === item) ? false : true;\n      if (shouleUpdate) {\n        callback();\n        hooks[currntIndex++] = depArr;\n      }\n    }\n  })\n})()\n\n")])])]),n("h2",{attrs:{id:"usecontext"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#usecontext"}},[e._v("#")]),e._v(" useContext")]),e._v(" "),n("p",[e._v("æ¥å—ä¸€ä¸ªcontextå¯¹è±¡å¹¶è¿”å›è¯¥contextçš„å½“å‰å€¼ï¼›è¯»å– context çš„å€¼ä»¥åŠè®¢é˜… contextçš„å˜åŒ–")]),e._v(" "),n("ul",[n("li",[e._v("useContext çš„å‚æ•°å¿…é¡»æ˜¯ context å¯¹è±¡æœ¬èº«")])]),e._v(" "),n("p",[n("strong",[e._v("åœ¨çˆ¶ç»„ä»¶ä¸­åˆ›å»ºä¸€ä¸ªcontext")])]),e._v(" "),n("ul",[n("li",[e._v("createContextï¼ˆï¼‰åˆ›å»ºä¸€ä¸ªä¸Šä¸‹æ–‡")]),e._v(" "),n("li",[e._v("Providerï¼šç”¨äºç”Ÿäº§å…±äº«æ•°æ®çš„åœ°æ–¹ï¼›valueï¼šç”¨äºæ”¾ç½®å…±äº«çš„æ•°æ®")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("// index.tsx\n// åˆ›å»ºä¸€ä¸ªcontext\nexport const NameContext = React.createContext({\n  name: \"é»˜è®¤åç§°\",\n  changeName: () => {}\n});\nclass App extends React.Component<initProps, initState> {\n  constructor (props:any) {\n    super (props);  \n    this.state = {\n      name: 'æˆ‘ä¸æ˜¯é»˜è®¤å€¼'\n    }\n  }\n  changeName = () => {\n    this.setState({\n      name: 'æˆ‘æ˜¯æ”¹å˜çš„å€¼'\n    })\n  };\n  render() {\n    return (\n     <NameContext.Provider value={{name: this.state.name, changeName: this.changeName}}>\n      {Routeconfig()}\n     </NameContext.Provider>\n    );\n  }\n};\n")])])]),n("p",[n("strong",[e._v("å­ç»„ä»¶ä¸­æ¶ˆè´¹context")])]),e._v(" "),n("ul",[n("li",[e._v("Consumerï¼šConsumeréœ€è¦åµŒå¥—åœ¨ç”Ÿäº§è€…(provider)ä¸‹é¢æ‰èƒ½é€šè¿‡å›è°ƒçš„æ–¹å¼æ‹¿åˆ°å…±äº«çš„æ•°æ®æºã€‚å½“ç„¶ä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ï¼ˆä¾‹å¦‚ä¸æ˜¯çˆ¶(index.tsx)å­(hook_component.tsx)å…³ç³»çš„list.tsxä¸index.tsxç»„ä»¶ï¼‰ï¼Œé‚£å°±åªèƒ½æ¶ˆè´¹åˆ°ä¸Šæ–‡æåˆ°çš„defaultValue")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import { NameContext } from '@/index';\nclass List extends React.Component<initProps, initState> {\n  render () {\n    return (\n      <NameContext.Consumer>\n        {\n          (context) => (\n            <>\n              <div>this is list page</div>\n              <p>{context.name}</p>\n            </>\n          )\n        }\n      </NameContext.Consumer>\n    )\n  }\n};\n")])])]),n("p",[e._v("å¦‚æœæŠŠå­ç»„ä»¶å†™æˆå‡½æ•°å¼ç»„ä»¶")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import * as React from 'react';\nimport { NameContext } from '@/index';\nexport function HookComponent () {\n  const context = React.useContext(NameContext);\n  return (\n    <>\n      <p>this is context {context.name}</p>\n      <button onClick={() => context.changeName()}>\n        cahngeContext\n      </button>\n    </>\n  );\n}\n")])])]),n("p",[e._v("å‚è€ƒä»£ç ï¼š"),n("a",{attrs:{href:"https://github.com/EvalGitHub/webpack_reactJS/blob/master/src/index.tsx",target:"_blank",rel:"noopener noreferrer"}},[e._v("index.txsã€hook_componen.tsxã€list.tsx"),n("OutboundLink")],1)]),e._v(" "),n("h2",{attrs:{id:"useref"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#useref"}},[e._v("#")]),e._v(" useRef")]),e._v(" "),n("p",[e._v("useRefå¯ç”¨äºè·å–å…ƒç´ èŠ‚ç‚¹ï¼Œå¸¸è§çš„æ“ä½œå°±æ˜¯è·å–inputè¿™ä¸ªå…ƒç´ ï¼Œå®ç°åˆå§‹åŒ–çš„è‡ªåŠ¨è·å–ç„¦ç‚¹ã€‚")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('const Example:React.FC<InitProps> = (props:InitProps) => {\n  const inputEl = useRef(null);\n  const onBtnClick = () => {\n    inputEl.current.focus();\n  };\n  return (\n    <>\n      <input ref={inputEl} type="text"/>\n      <button onClick={onBtnClick}>clickBtn</button>\n    </>\n  );\n}\n')])])]),n("p",[e._v("ä¸Šé¢çš„ä¾‹å­å¯ä»¥æ¸…æ™°çœ‹åˆ°ï¼Œä½¿ç”¨useRefè·å–äº†inputè¿™ä¸ªå…ƒç´ èŠ‚ç‚¹ï¼Œç„¶åä¿®æ”¹å±æ€§è‡ªåŠ¨è·å–ç„¦ç‚¹ã€‚")]),e._v(" "),n("p",[n("strong",[e._v("useRefè¿”å›çš„refå¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä¿æŒä¸å˜")])]),e._v(" "),n("p",[e._v("åˆ©ç”¨ä¸Šé¢çš„è¿™ä¸ªç‰¹æ€§èƒ½åšè§„é¿å¾ˆå¤šé—®é¢˜ï¼š")]),e._v(" "),n("ol",[n("li",[e._v("timeoutä¸­è¯»ä¸åˆ°å…¶ä»–çŠ¶æ€çš„æ–°å€¼")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('export default function App() {\n  const [flag, setValue] = React.useState(false);\n  function dealClick() {\n    setValue(!flag);\n    timer = window.setTimeout(() => {\n      setValue(!flag);\n      console.log(value);\n    }, 1000);\n  }\n  return (\n    <>\n      <p>{value ? "true" : "false"}</p>\n      <button onClick={dealClick}>click me </button>\n    </>\n  );\n}\n')])])]),n("p",[e._v("æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨ç‚¹å‡»æŒ‰é’®ä¹‹åç•Œé¢ä¸Šæ˜¾ç¤ºtrueï¼Œ1sä¹‹åæ‰“å°å‡ºfalse,ä½†æ˜¯ç•Œé¢å¹¶æ²¡æœ‰æ›´æ–°ä¸ºfalseï¼Œä¸Šé¢çš„é—®é¢˜å°±æ˜¯"),n("strong",[e._v("setValue(!flag)")]),e._v("\nè¿™å¥æœ‰é—®é¢˜ï¼Œå› ä¸ºsetValueæ˜¯ç”¨æ¥ä¿®æ”¹flagï¼ˆflagæ˜¯ä¸€ä¸ªçŠ¶æ€ï¼Œå¯¹äºçŠ¶æ€çš„ä¿®æ”¹å¿…é¡»è¿”å›æ–°çš„stateæ‰ä¼šæ˜¯çš„è§†å›¾æ›´æ–°ï¼‰")]),e._v(" "),n("p",[e._v("ä½¿ç”¨UseRefæ¥æ•‘åœº")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("export default function App() {\n  const [flag, setValue] = React.useState(false);\n  const valueRef = React.useRef(flag); \n  valueRef.current = flag;\n\n  function dealClick() {\n    setValue(!valueRef.current); \n    timer = window.setTimeout(() => {\n      setValue(!valueRef.current);\n    }, 1000);\n  }\n  return (\n    <>\n      <p>{valueRef.current}</p>\n      <button onClick={dealClick}>click me </button>\n    </>\n  );\n}\n")])])]),n("p",[e._v("å› ä¸ºvalueRef.currentå¯¹äºflagæ¥è¯´å°±æ˜¯ä¸€ä¸ªæ–°çš„çŠ¶æ€ã€‚")]),e._v(" "),n("h2",{attrs:{id:"usereducer"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#usereducer"}},[e._v("#")]),e._v(" useReducer")]),e._v(" "),n("p",[e._v("å¯ä»¥çœ‹åšæ˜¯useStateçš„æ›¿ä»£æ–¹æ¡ˆ")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const [state, dispatch] = useReducer(reducer, initialArg, init);\n")])])]),n("p",[e._v("useReducer ä¼šæ¯” useState æ›´é€‚ç”¨ï¼Œä¾‹å¦‚ state é€»è¾‘è¾ƒå¤æ‚ä¸”åŒ…å«å¤šä¸ªå­å€¼ï¼Œæˆ–è€…ä¸‹ä¸€ä¸ª state ä¾èµ–äºä¹‹å‰çš„ state ç­‰ã€‚å¹¶ä¸”ï¼Œä½¿ç”¨ useReducer è¿˜èƒ½ç»™é‚£äº›ä¼šè§¦å‘æ·±æ›´æ–°çš„ç»„ä»¶åšæ€§èƒ½ä¼˜åŒ–ï¼Œ"),n("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down",target:"_blank",rel:"noopener noreferrer"}},[e._v("å› ä¸ºä½ å¯ä»¥å‘å­ç»„ä»¶ä¼ é€’ dispatch è€Œä¸æ˜¯å›è°ƒå‡½æ•°"),n("OutboundLink")],1),e._v("ã€‚")]),e._v(" "),n("p",[e._v("ç¤ºä¾‹ä»£ç å‚è€ƒå®˜ç½‘ï¼š"),n("a",{attrs:{href:"https://zh-hans.reactjs.org/docs/hooks-reference.html#usereducer",target:"_blank",rel:"noopener noreferrer"}},[e._v("ä»£ç "),n("OutboundLink")],1)]),e._v(" "),n("p",[n("strong",[e._v("æ¯”è¾ƒuseStateï¼ŒuseReducer")])]),e._v(" "),n("p",[e._v("ä½¿ç”¨useStateçš„æƒ…å†µï¼š")]),e._v(" "),n("ul",[n("li",[e._v("state ä¸ºåŸºæœ¬ç±»å‹ï¼ˆä¹Ÿè¦çœ‹æƒ…å†µï¼‰")]),e._v(" "),n("li",[e._v("state è½¬æ¢é€»è¾‘ç®€å•çš„åœºæ™¯")]),e._v(" "),n("li",[e._v("state è½¬æ¢åªä¼šåœ¨å½“å‰ç»„ä»¶ä¸­å‡ºç°ï¼Œå…¶ä»–ç»„ä»¶ä¸éœ€è¦æ„ŸçŸ¥è¿™ä¸ª state")]),e._v(" "),n("li",[e._v("å¤šä¸ª useState hooks ä¹‹é—´çš„ state å¹¶æ²¡æœ‰å…³è”å…³ç³»")])]),e._v(" "),n("p",[e._v("ä½¿ç”¨ useReducer çš„æƒ…å†µï¼š")]),e._v(" "),n("ul",[n("li",[e._v("state ä¸ºå¼•ç”¨ç±»å‹ï¼ˆä¹Ÿè¦çœ‹æƒ…å†µï¼‰")]),e._v(" "),n("li",[e._v("state è½¬æ¢é€»è¾‘æ¯”è¾ƒå¤æ‚çš„åœºæ™¯")]),e._v(" "),n("li",[e._v("ä¸åŒ state ä¹‹é—´å­˜åœ¨è¾ƒå¼ºçš„å…³è”å…³ç³»ï¼Œåº”è¯¥ä½œä¸ºä¸€ä¸ª objectï¼Œç”¨ä¸€ä¸ª state æ¥è¡¨ç¤ºçš„åœºæ™¯")])]),e._v(" "),n("h3",{attrs:{id:"usereducerçš„ä½¿ç”¨æ–¹æ³•"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#usereducerçš„ä½¿ç”¨æ–¹æ³•"}},[e._v("#")]),e._v(" useReducerçš„ä½¿ç”¨æ–¹æ³•")]),e._v(" "),n("p",[e._v("store.js")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import React from 'react';\nconst store = React.createContext(null);\n\nexport const initialState  = {\n // ....\n // ...\n}\n\nexport const reducer = (state, action) => {\n  switch (action.type) {\n    // ...\n  }\n}\n\nexport default store\n")])])]),n("p",[e._v("Provideræ ¹ç»„ä»¶çš„æŒ‚è½½")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import React, { useReducer } from 'react'\nimport store, { reducer, initialState } from './store'\n\nfunction App() {\n  const [state, dispatch] = useReducer(reducer, initialState)\n  return (\n     <store.Provider value={{ state, dispatch }}>\n      <div/>\n     </store>\n  )\n}\n")])])]),n("p",[e._v("ä¸šåŠ¡ç»„ä»¶å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("import React, { useContext } from 'react'\nimport store from './store'\n\ncosnt Child = props => {\n  const { state, dispatch } = useContext(store)\n  // ...\n  return (\n    <>\n      <button onClick={() => dispatch({type: 'increment'})}>+</button>\n    </>\n  )\n}\n")])])]),n("h2",{attrs:{id:"usecallback-usememo"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#usecallback-usememo"}},[e._v("#")]),e._v(" useCallbackï¼ŒuseMemo")]),e._v(" "),n("p",[e._v("è¿™ä¸¤ä¸ªhookå¯ç”¨äºä¼˜åŒ–reactæ€§èƒ½ï¼Œåœ¨é¡¹ç›®ä¸­ç»å¸¸ä¼šå­˜åœ¨å¤§æ‰¹é‡çš„é€»è¾‘è¿ç®—ï¼Œå…¶ä¸­æœ‰äº›å‡½æ•°æ˜¯çº¯å‡½æ•°ï¼ˆæ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨ï¼‰ï¼Œç›¸åŒçš„è¾“å…¥ä¼šè¿”å›ç›¸åŒçš„ç»“æœï¼Œä½†æ˜¯å¦‚æœä¸åšå¤„ç†ï¼Œè¿™äº›è®¡ç®—ä¼šåœ¨reactç»„ä»¶é‡æ–°æ¸²æŸ“çš„æ—¶å€™ä¼šåˆä¸€æ¬¡çš„å»æ‰§è¡Œï¼Œæ‰€æœ‰æˆ‘ä»¬æœ‰å¿…è¦å°†è¿™äº›çº¯å‡½æ•°é€»è¾‘è¿›è¡Œç¼“å­˜ï¼Œå¯¹äºç›¸åŒè¾“å…¥çš„\næƒ…å†µç›´æ¥å»ç¼“å­˜ç»“æœï¼Œè€Œä¸éœ€è¦é‡æ–°è®¡ç®—ï¼Œè¿™å°±æ˜¯useCallbackï¼ŒuseMemoå­˜åœ¨çš„ç›®çš„ã€‚")]),e._v(" "),n("blockquote",[n("p",[e._v("reack hookåœ¨ç»„ä»¶diffçš„æ—¶å€™æ˜¯ä¼šé‡æ–°æ‰§è¡Œä¸€éçš„ï¼Œè¿™å°±æ„å‘³ç€å¦‚æœä½ åœ¨reactç»„ä»¶ä¸­å®šä¹‰æ™®é€šå˜é‡éƒ½ä¼šé‡æ–°åˆå§‹åŒ–ï¼Œä½†æ˜¯\nå¦‚æœä½¿ç”¨çš„æ˜¯useStateç­‰hookå‡½æ•°å£°æ˜çš„å˜é‡åªèƒ½è¢«æ˜¯å¯¹åº”çš„å‡½æ•°æ›´æ–°ã€‚")])]),e._v(" "),n("p",[e._v("useCallbackè¿”å›ç¼“å­˜çš„å‡½æ•°")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const memoizedCallback = useCallback(\n  () => {\n    doSomething(a, b);\n  },\n  [a, b],\n);\n")])])]),n("p",[e._v("useMemoè¿”å›ç¼“å­˜çš„å˜é‡")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const expensiveCount = useMemo(() => {\n  let sum = 0;\n  for (let i = 0; i < count * 100; i++) {\n    sum += i;\n  }\n  return sum;\n}, [count]);\n")])])]),n("p",[e._v("useCallback(fn, deps) ç›¸å½“äº useMemo(() => fn, deps)ã€‚")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://blog.csdn.net/hesongGG/article/details/84347484",target:"_blank",rel:"noopener noreferrer"}},[e._v("reactä¸­useMemoçš„ç”¨æ³•"),n("OutboundLink")],1)]),e._v(" "),n("h2",{attrs:{id:"useimperativehandle"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#useimperativehandle"}},[e._v("#")]),e._v(" useImperativeHandle")]),e._v(" "),n("ul",[n("li",[e._v("ä½¿ç”¨ ref æ—¶è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼ï¼ŒuseImperativeHandle åº”å½“ä¸ forwardRef ä¸€èµ·ä½¿ç”¨ã€‚")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("function FancyInput(props, ref) {\n  const inputRef = useRef();\n  useImperativeHandle(ref, () => ({\n    focus: () => {\n      inputRef.current.focus();\n    }\n  }));\n  return <input ref={inputRef} ... />;\n}\nFancyInput = forwardRef(FancyInput);\n")])])]),n("p",[e._v("å¦å¤–çš„ä½¿ç”¨åœºæ™¯ï¼š")]),e._v(" "),n("blockquote",[n("p",[e._v("åœ¨reactä¸­å‡½æ•°ç»„ä»¶æ˜¯æ²¡æœ‰å¯¹åº”å®ä¾‹çš„ï¼Œå› æ­¤å¦‚æœå¯¹ç»„ä»¶ä½¿ç”¨refï¼Œæƒ³è·å–ç»„ä»¶çš„æ–¹æ³•ï¼Œä¼šå¤±è´¥ï¼›useImperativeHandleæä¾›äº†ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("function OnLineModal(props:InitProps, ref:React.Ref<null>) {\n  const [modalVisible, setModalVisible] = React.useState<boolean>(false);\n  React.useImperativeHandle(ref, () : any => ({\n    setModalVisible: (flag:boolean) => setModalVisible(flag),\n  }));\n\n  return <ContainModal visible={modalVisible}/>;\n}\nexport const OnLineModalCom = React.forwardRef(OnLineModal); \n")])])]),n("p",[e._v("çˆ¶ç»„ä»¶ï¼š")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("function StateList(props:InitProps) {\n  const OnLineModalRef:React.Ref<null> = React.createRef();\n  function getRefVal() {\n    console.log(OnLineModalRef); // {setModalVisible:f}\n  }\n  return <section>\n    <button onClick={getRefVal}>get Ref value</button>\n    <OnLineModalCom ref = {OnLineModalRef}/>\n  </section>\n}\n")])])]),n("ul",[n("li",[e._v("è¿›é˜¶ï¼šå¦‚æœæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œæ¯ä¸ªåˆ—è¡¨é¡¹éƒ½æ˜¯å‡½æ•°ç»„ä»¶ï¼Œæƒ³è·å–æ¯ä¸€ä¸ªå‡½æ•°ç»„ä»¶çš„å®ä¾‹ï¼Ÿ")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('const LIST = ["ce", "shi", "demo"];\nconst Item: React.FC<{\n  label: string;\n  idx: number;\n  ref: Ref;\n}> = forwardRef(({ label, idx }, ref) => {\n  const innerMethod = () => {\n    console.log(`${label}-${idx}`);\n  };\n\n  useImperativeHandle(ref, {\n    [`you example-${idx}`]: innerMethod\n  });\n  return <p>{label}</p>;\n});\n\nexport const MutilApp: React.FC = () => {\n  const globalRef = useRef(null);\n\n  const invokeAllMountMethod = () => {\n    const globalObject = globalRef?.current;\n    for (const [, method] of Object.entries(globalObject)) {\n      method();\n    }\n  };\n\n  return (\n    <>\n      <button\n        onClick={() => {\n          invokeAllMountMethod();\n        }}\n      >\n        INVOKE\n      </button>\n      {LIST.map((item, idx) => (\n        <Item label={item} idx={idx} key={item} ref={globalRef} />\n      ))}\n    </>\n  );\n};\n')])])]),n("p",[e._v("ç°åœ¨çš„ä»£ç å¦‚ä¸Šï¼Œå¦‚æœç‚¹å‡»è¿™ä¸ªæŒ‰é’®ï¼Œä¼šå‘ç°æœ€çµ‚çš„çµæœå°±æ˜¯â€œdemo-02â€ï¼Œ\né‚£éº½è©²å¦‚ä½•è·å–åˆ°æ‰€æœ‰çš„å®ä¾‹å‘¢ï¼Ÿï¼Ÿ")]),e._v(" "),n("blockquote",[n("p",[e._v("å®é™…ä¸Šï¼Œæˆ‘ä»¬åœ¨å‰é¢ä¹Ÿæåˆ°äº†è¿™ä¸€ç‚¹ï¼šä¸€æ ¹å‚ç›´ç®¡é“ï¼Œä½ åœ¨ä¸Šæ–¹æŠ•å…¥äº†ä»€ä¹ˆï¼Œä¸‹æ–¹æ‹¿åˆ°çš„å°±æ˜¯ä»€ä¹ˆï¼Œ æˆ‘ä»¬å§‹ç»ˆåªæœ‰ä¸€ä¸ªglobalRefï¼Œå› æ­¤å¤šæ¬¡è°ƒç”¨ä¸‹æœ€åä¸€æ¬¡çš„æŒ‚è½½è¦†ç›–æ‰äº†å‰é¢çš„ã€‚")])]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('import {Ref, useImperativeHandle, MutableRefObject } from "react";\n\nconst useMultiImperativeHandle = <T, K extends object>(\n  originRef: Ref,\n  convertRefObj: K,\n  deps?:any\n): void => {\n  return useImperativeHandle(\n    originRef,\n    () => {\n      return {\n        ...originRef.current,\n        ...convertRefObj\n      };\n    },\n    deps\n  );\n};\n\nexport default useMultiImperativeHandle;\n')])])]),n("p",[e._v("æºç ä¸­ä½¿ç”¨ï¼š")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v("const Item: React.FC<{\n  label: string;\n  idx: number;\n  ref: Ref;\n}> = forwardRef(({ label, idx }, ref) => {\n  const innerMethod = () => {\n    console.log(`${label}-${idx}`);\n  };\n\n  useMultiImperativeHandle(ref, {\n    [`method-from-${idx}`]: innerMethod\n  });\n\n  return <p>{label}</p>;\n});\n")])])]),n("h2",{attrs:{id:"uselayouteffect"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#uselayouteffect"}},[e._v("#")]),e._v(" useLayoutEffect")]),e._v(" "),n("blockquote",[n("p",[e._v("åœ¨æ‰€æœ‰çš„ DOM å˜æ›´ä¹‹ååŒæ­¥è°ƒç”¨effectã€‚å¯ä»¥ä½¿ç”¨å®ƒæ¥"),n("strong",[e._v("è¯»å– DOM å¸ƒå±€å¹¶åŒæ­¥\nè§¦å‘é‡æ¸²æŸ“")]),e._v("ã€‚"),n("strong",[e._v("åœ¨æµè§ˆå™¨æ‰§è¡Œç»˜åˆ¶ä¹‹å‰ï¼ŒuseLayoutEffect å†…éƒ¨çš„æ›´æ–°è®¡åˆ’å°†è¢«åŒ\næ­¥åˆ·æ–°")]),e._v("ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¼šé˜»å¡æµè§ˆå™¨ç»˜åˆ¶ã€‚æ‰€ä»¥å°½å¯èƒ½ä½¿ç”¨ useEffect ä»¥é¿å…é˜»\nå¡è§†è§‰æ›´æ–°ã€‚")])]),e._v(" "),n("p",[e._v("å¦‚æœåªæ˜¯å¤§é‡çš„æ•°æ®å¤„ç†ï¼Œå»ºè®®ä½¿ç”¨useEffectæ¥è¿›è¡Œå¤„ç†ï¼›å¦‚æœè®¾è®¡åˆ°åŠ¨ç”»æ•ˆæœï¼Œåœ¨é¦–æ¬¡å±•ç¤ºçš„æ—¶å€™éœ€è¦ä¸€ä¸ªå¾ˆæµç•…çš„ä½“éªŒï¼Œå¯ä»¥å€ŸåŠ©useLayoutEffectæ¥è¿›è¡Œ")]),e._v(" "),n("p",[e._v("å…·ä½“æ•ˆæœdemoï¼š")]),e._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[e._v('import React, { useEffect, useLayoutEffect, useRef } from "react";\nimport "./styles.css";\n\nconst UseEffect: React.FC<any> = () => {\n  const box = useRef();\n  useEffect(() => {\n    (box.current as any).style.marginLeft = 100 + "px";\n  }, []);\n  return (\n    <div className="box box1" ref={box}>\n      useEffect\n    </div>\n  );\n};\nconst UseLayoutEffect: React.FC<any> = () => {\n  const box = useRef();\n  useLayoutEffect(() => {\n    (box.current as any).style.marginLeft = 100 + "px";\n  }, []);\n  return (\n    <div className="box box2" ref={box}>\n      UseLayoutEffect\n    </div>\n  );\n};\n\nexport default function App() {\n  return (\n    <div className="App">\n      <h1>åˆ·æ–°æµè§ˆå™¨çœ‹ä¸‹åŒºåˆ«æ•ˆæœ</h1>\n      <UseEffect />\n      <UseLayoutEffect />\n    </div>\n  );\n}\n')])])]),n("p",[e._v("å¯ä»¥çœ‹åˆ°ä½¿ç”¨useEffectçš„æ—¶å€™ï¼Œç•Œé¢åŠ¨æ•ˆä¼šæœ‰ç‚¹ç”Ÿç¡¬ï¼›ä½¿ç”¨useLayoutEffectæ—¶å€™å°±å¾ˆæµç•…ï¼›\nåŸå› å°±æ˜¯useLayoutEffectä¼šåœ¨ç•Œé¢æ¸²æŸ“ä¹‹å‰å°±å®Œæˆäº†è®¡ç®—æ›´æ–°ï¼ŒåŒæ­¥å®Œæˆçš„ï¼Œç„¶åæ‰ä¼šè¢«æµè§ˆå™¨\næ¸²æŸ“ã€‚")]),e._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.im/post/5dbbdbd5f265da4d4b5fe57d",target:"_blank",rel:"noopener noreferrer"}},[e._v("React Hooks è¯¦è§£ ã€è¿‘ 1W å­—ã€‘+ é¡¹ç›®å®æˆ˜"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"https://juejin.im/post/5ec7372cf265da76de5cd0c9?utm_source=gold_browser_extension#heading-14",target:"_blank",rel:"noopener noreferrer"}},[e._v("react hookè¿›é˜¶"),n("OutboundLink")],1)]),e._v(" "),n("p",[n("a",{attrs:{href:"https://www.zhihu.com/question/350523308/answer/858145147",target:"_blank",rel:"noopener noreferrer"}},[e._v("ä½¿ç”¨ React Hooks çš„å¿ƒæ™ºè´Ÿæ‹…"),n("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=s.exports}}]);