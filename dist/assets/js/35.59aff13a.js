(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{464:function(n,e,t){n.exports=t.p+"assets/img/vue-ins.65f6283b.png"},611:function(n,e,t){"use strict";t.r(e);var r=t(28),a=Object(r.a)({},(function(){var n=this,e=n.$createElement,r=n._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[r("h1",{attrs:{id:"如何写一个vite插件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#如何写一个vite插件"}},[n._v("#")]),n._v(" 如何写一个vite插件")]),n._v(" "),r("h2",{attrs:{id:"熟悉插件钩子"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#熟悉插件钩子"}},[n._v("#")]),n._v(" 熟悉插件钩子")]),n._v(" "),r("ul",[r("li",[n._v("config")])]),n._v(" "),r("blockquote",[r("p",[n._v("可用于修改vite的配置")])]),n._v(" "),r("ul",[r("li",[n._v("configResolved")])]),n._v(" "),r("blockquote",[r("p",[n._v("vite 陪你确认")])]),n._v(" "),r("ul",[r("li",[n._v("configureServer")])]),n._v(" "),r("blockquote",[r("p",[n._v("用于配置dev server")])]),n._v(" "),r("ul",[r("li",[n._v("transformIndexHtml")])]),n._v(" "),r("blockquote",[r("p",[n._v("转换页面")])]),n._v(" "),r("ul",[r("li",[n._v("resolved")])]),n._v(" "),r("blockquote",[r("p",[n._v("创建自定义确认函数，常用于定义第三方依赖")])]),n._v(" "),r("ul",[r("li",[n._v("load")])]),n._v(" "),r("blockquote",[r("p",[n._v("创建自定义加载函数，用于返回自定义内容")])]),n._v(" "),r("ul",[r("li",[n._v("transform")])]),n._v(" "),r("blockquote",[r("p",[n._v("用于转换加载的模块内容")])]),n._v(" "),r("ul",[r("li",[n._v("handleHotUpdate")])]),n._v(" "),r("blockquote",[r("p",[n._v("自定义HMR更新时调用")])]),n._v(" "),r("h2",{attrs:{id:"写一个插件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#写一个插件"}},[n._v("#")]),n._v(" 写一个插件")]),n._v(" "),r("p",[n._v("vite的插件在vite.config.js的plugins中配置，有两种形式：对象，函数（可接受配置参数）")]),n._v(" "),r("p",[n._v("使用方式：直接在vite.config.js文件中plugins中配置")]),n._v(" "),r("ul",[r("li",[n._v("写一个i18n的简单插件")])]),n._v(" "),r("ol",[r("li",[n._v("创建文件  plugins/i18n-plugins.js")])]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("export default {\n    // code是块的内容\n    // id 是文件url\n    transform(code, id) {\n        if (/vue&type=i18n/.test(id)) {\n            // 对于新添加的标签会，发送一个请求，因此只需要根据路径做拦截判读\n            return `export default Comp => {\n                Comp.i18n = ${code}\n            }`\n        }\n        return null;\n    }\n}\n")])])]),r("ol",{attrs:{start:"2"}},[r("li",[n._v("引入自定义插件 （vite.config.js中引入自己创建的插件）")])]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("import { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nconst path = require('path');\n\nimport i18n from './plugin/i18n-plugin';\n\nexport default defineConfig({\n    server: {\n     port: '4000',\n      proxy: {\n          '/api': {\n              target: 'https//jsonplaceholder.typicode.com',\n              chargeOrigin: true,\n                rewrite: path => path.replace(/^\\/api/, '')\n            }\n        }\n    },\n    resolve: {\n        alias: {\n            '@': path.resolve('./src'),\n            comps: path.resolve('./src/components')\n        }\n    },\n    plugins: [vue(), i18n]\n})\n")])])]),r("ol",{attrs:{start:"3"}},[r("li",[n._v("源码中使用")])]),n._v(" "),r("p",[n._v("可以通通过，getCurrentInstance获取组件实例")]),n._v(" "),r("p",[r("img",{attrs:{src:t(464),alt:"avatar"}})]),n._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[n._v("<template>\n    <label>国际化：</label>\n    <select v-model='local'>\n        <option value='en'>en</option>\n        <option value='zh'>zh</option>\n    </select>\n    <p>{{t('hello')}}</p>\n</template>\n<i18n>\n  {\n      'en': {\n        'language': 'Language',\n        'hello': 'hello world'\n      },\n      'zh': {\n        'language': '语言',\n        'hello': '你好世界'\n      }\n  }\n</i18n>\n\n<script>\n    import {getCurrentInstance, ref, computed} from 'vue';\n\n    const ins = getCurrentInstance(); // 获取组件实例\n\n    function useI18n() {\n        const local = ref('zh');\n        const i18n = ins.type.i18n;\n        const t = msg => {\n            return computed(() => i18n[local.value][msg]).value\n            // return computed(() => LanguageJson[local.value][msg]).value\n        }\n        return {local, t}\n    };\n\n    const {local, t} = useI18n();\n<\/script>\n")])])]),r("p",[n._v("参考：\n"),r("a",{attrs:{href:"https://vitejs.dev/guide/api-plugin.html",target:"_blank",rel:"noopener noreferrer"}},[n._v("vite插件api hook"),r("OutboundLink")],1),n._v(" 、\n"),r("a",{attrs:{href:"https://github.com/EvalGitHub/vite-vue3",target:"_blank",rel:"noopener noreferrer"}},[n._v("i18n实例"),r("OutboundLink")],1),n._v("，\n"),r("a",{attrs:{href:"https://juejin.cn/post/6948390250003562532",target:"_blank",rel:"noopener noreferrer"}},[n._v("vite插件，实现将markdown转成vue组件"),r("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=a.exports}}]);